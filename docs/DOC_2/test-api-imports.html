<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Import Test - MyBonzo</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            margin: 0;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            text-align: center;
            color: #00d4ff;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            margin: 20px 0;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .bigquery { border-left-color: #007bff; }
        .kaggle { border-left-color: #ffc107; }
        .voice { border-left-color: #28a745; }
        
        .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .success { background: rgba(40, 167, 69, 0.3); color: #28a745; }
        .error { background: rgba(220, 53, 69, 0.3); color: #dc3545; }
        .loading { background: rgba(255, 193, 7, 0.3); color: #ffc107; }
        
        .test-button {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }
        
        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.3);
        }
        
        .log {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .timestamp {
            color: #888;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¨ API Import Test</h1>
        
        <div class="test-section bigquery">
            <h3>üìä BigQuery API 
                <span id="bigquery-status" class="status loading">Testing...</span>
            </h3>
            <p>Test dynamicznego importu BigQuery API</p>
            <button class="test-button" onclick="testBigQueryConnection()">Test Connection</button>
            <button class="test-button" onclick="bigQueryQuickQuery('overview')">Quick Query</button>
            <div id="bigquery-log" class="log"></div>
        </div>
        
        <div class="test-section kaggle">
            <h3>üèÜ Kaggle API 
                <span id="kaggle-status" class="status loading">Testing...</span>
            </h3>
            <p>Test dynamicznego importu Kaggle API</p>
            <button class="test-button" onclick="testKaggleConnection()">Test Connection</button>
            <button class="test-button" onclick="kaggleQuickSearch('polish-nlp')">Search Polish NLP</button>
            <div id="kaggle-log" class="log"></div>
        </div>
        
        <div class="test-section voice">
            <h3>üé§ Voice AI API 
                <span id="voice-status" class="status loading">Testing...</span>
            </h3>
            <p>Test dynamicznego importu Voice AI API</p>
            <button class="test-button" onclick="testVoiceAiStatus()">Test Status</button>
            <button class="test-button" onclick="quickSynthesizeTest()">Test Synthesis</button>
            <div id="voice-log" class="log"></div>
        </div>
        
        <div style="text-align: center; margin-top: 30px;">
            <button class="test-button" onclick="runAllTests()" style="font-size: 16px; padding: 15px 30px;">
                üöÄ Run All Tests
            </button>
        </div>
    </div>

    <script type="module">
        // Utility functions
        function logMessage(section, message, type = 'info') {
            const logDiv = document.getElementById(`${section}-log`);
            const timestamp = new Date().toLocaleTimeString();
            const typeColor = type === 'error' ? '#ff6b6b' : type === 'success' ? '#51cf66' : '#74c0fc';
            
            logDiv.innerHTML += `
                <div style="margin-bottom: 5px;">
                    <span class="timestamp">[${timestamp}]</span>
                    <span style="color: ${typeColor}">[${type.toUpperCase()}]</span>
                    ${message}
                </div>
            `;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function updateStatus(section, status, message = '') {
            const statusEl = document.getElementById(`${section}-status`);
            statusEl.className = `status ${status}`;
            statusEl.textContent = message || (status === 'success' ? 'OK' : status === 'error' ? 'Failed' : 'Testing...');
        }

        // Test BigQuery API Import
        async function testBigQueryImport() {
            try {
                logMessage('bigquery', 'Rozpoczynam import BigQuery API...', 'info');
                
                const module = await import('./src/utils/bigQueryAPI.js');
                window.BigQueryAPI = module.BigQueryAPI;
                window.BigQueryInterface = module.BigQueryInterface;
                
                logMessage('bigquery', '‚úÖ BigQuery API imported successfully', 'success');
                updateStatus('bigquery', 'success', 'Loaded');
                
                // Initialize interface
                if (!window.bigQueryInterface) {
                    window.bigQueryInterface = new window.BigQueryInterface();
                }
                
                return true;
            } catch (error) {
                logMessage('bigquery', `‚ùå BigQuery import failed: ${error.message}`, 'error');
                updateStatus('bigquery', 'error', 'Failed');
                console.error('BigQuery import error:', error);
                return false;
            }
        }

        // Test Kaggle API Import
        async function testKaggleImport() {
            try {
                logMessage('kaggle', 'Rozpoczynam import Kaggle API...', 'info');
                
                const module = await import('./src/utils/kaggleAPI.js');
                window.KaggleAPI = module.KaggleAPI;
                window.KaggleInterface = module.KaggleInterface;
                
                logMessage('kaggle', '‚úÖ Kaggle API imported successfully', 'success');
                updateStatus('kaggle', 'success', 'Loaded');
                
                // Initialize interface
                if (!window.kaggleInterface) {
                    window.kaggleInterface = new window.KaggleInterface();
                }
                
                return true;
            } catch (error) {
                logMessage('kaggle', `‚ùå Kaggle import failed: ${error.message}`, 'error');
                updateStatus('kaggle', 'error', 'Failed');
                console.error('Kaggle import error:', error);
                return false;
            }
        }

        // Test Voice AI API Import
        async function testVoiceAiImport() {
            try {
                logMessage('voice', 'Rozpoczynam import Voice AI API...', 'info');
                
                const module = await import('./src/utils/voiceAiAPI.js');
                window.VoiceAIAPI = module.VoiceAIAPI;
                window.VoiceAIInterface = module.VoiceAIInterface;
                
                logMessage('voice', '‚úÖ Voice AI API imported successfully', 'success');
                updateStatus('voice', 'success', 'Loaded');
                
                // Initialize interface
                if (!window.voiceAiInterface) {
                    window.voiceAiInterface = new window.VoiceAIInterface();
                }
                
                return true;
            } catch (error) {
                logMessage('voice', `‚ùå Voice AI import failed: ${error.message}`, 'error');
                updateStatus('voice', 'error', 'Failed');
                console.error('Voice AI import error:', error);
                return false;
            }
        }

        // Global test functions
        window.testBigQueryConnection = async function() {
            const imported = await testBigQueryImport();
            if (imported && window.bigQueryInterface) {
                try {
                    logMessage('bigquery', 'Testing connection...', 'info');
                    await window.bigQueryInterface.testConnection();
                } catch (error) {
                    logMessage('bigquery', `Connection test error: ${error.message}`, 'error');
                }
            }
        };

        window.bigQueryQuickQuery = async function(type) {
            const imported = await testBigQueryImport();
            if (imported && window.bigQueryInterface) {
                try {
                    logMessage('bigquery', `Running quick query: ${type}`, 'info');
                    await window.bigQueryInterface.quickQuery(type);
                } catch (error) {
                    logMessage('bigquery', `Quick query error: ${error.message}`, 'error');
                }
            }
        };

        window.testKaggleConnection = async function() {
            const imported = await testKaggleImport();
            if (imported && window.kaggleInterface) {
                try {
                    logMessage('kaggle', 'Testing connection...', 'info');
                    await window.kaggleInterface.testConnection();
                } catch (error) {
                    logMessage('kaggle', `Connection test error: ${error.message}`, 'error');
                }
            }
        };

        window.kaggleQuickSearch = async function(type) {
            const imported = await testKaggleImport();
            if (imported && window.kaggleInterface) {
                try {
                    logMessage('kaggle', `Running quick search: ${type}`, 'info');
                    await window.kaggleInterface.quickSearch(type);
                } catch (error) {
                    logMessage('kaggle', `Quick search error: ${error.message}`, 'error');
                }
            }
        };

        window.testVoiceAiStatus = async function() {
            const imported = await testVoiceAiImport();
            if (imported && window.voiceAiInterface) {
                try {
                    logMessage('voice', 'Testing Voice AI status...', 'info');
                    await window.voiceAiInterface.checkStatus();
                } catch (error) {
                    logMessage('voice', `Status check error: ${error.message}`, 'error');
                }
            }
        };

        window.quickSynthesizeTest = async function() {
            const imported = await testVoiceAiImport();
            if (imported && window.voiceAiInterface) {
                try {
                    logMessage('voice', 'Testing text synthesis...', 'info');
                    await window.voiceAiInterface.quickSynthesize('Witaj, to jest test syntezy mowy.');
                } catch (error) {
                    logMessage('voice', `Synthesis test error: ${error.message}`, 'error');
                }
            }
        };

        window.runAllTests = async function() {
            logMessage('bigquery', 'Starting comprehensive test suite...', 'info');
            logMessage('kaggle', 'Starting comprehensive test suite...', 'info');
            logMessage('voice', 'Starting comprehensive test suite...', 'info');
            
            const results = await Promise.allSettled([
                testBigQueryImport(),
                testKaggleImport(),
                testVoiceAiImport()
            ]);
            
            const successful = results.filter(r => r.status === 'fulfilled' && r.value).length;
            
            console.log(`\nüéØ Test Results: ${successful}/3 APIs imported successfully`);
            
            if (successful === 3) {
                alert('üéâ All APIs imported successfully! The dynamic import fix worked.');
            } else {
                alert(`‚ö†Ô∏è ${successful}/3 APIs imported. Check console for details.`);
            }
        };

        // Auto-run tests on load
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üöÄ Starting API import tests...');
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>
