import{r as l,j as e}from"./react.0nTXIzv_.js";import"./Header.astro_astro_type_script_index_0_lang.C3v9REYp.js";if(typeof MessageChannel>"u"){class r{constructor(){this.onmessage=null}postMessage(s){const n={data:s};(typeof queueMicrotask=="function"?queueMicrotask:a=>setTimeout(a,0))(()=>this.onmessage&&this.onmessage(n))}start(){}close(){}}class o{constructor(){this.port1=new r,this.port2=new r;const s=(n,a)=>{const c={data:a};(typeof queueMicrotask=="function"?queueMicrotask:i=>setTimeout(i,0))(()=>n.onmessage&&n.onmessage(c))};this.port1.postMessage=n=>s(this.port2,n),this.port2.postMessage=n=>s(this.port1,n)}}globalThis.MessageChannel=o}const b={secretKey:"MYBONZO_SECRET_2025",tokenExpiry:36e5,roles:{admin:["read","write","delete","manage_users","system_control"],moderator:["read","write","manage_content"],viewer:["read"]}},w={admin:{password:"HAOS77",role:"admin"},moderator:{password:"MOD2025",role:"moderator"},viewer:{password:"VIEW2025",role:"viewer"}};class S{static encode(o){const t=btoa(JSON.stringify({alg:"HS256",typ:"JWT"})),s=btoa(JSON.stringify(o)),n=btoa(`${t}.${s}.${b.secretKey}`);return`${t}.${s}.${n}`}static decode(o){try{const[t,s,n]=o.split("."),a=btoa(`${t}.${s}.${b.secretKey}`);if(n!==a)throw new Error("Invalid signature");return JSON.parse(atob(s))}catch{throw new Error("Invalid token")}}static authenticate(o,t){const s=w[o];if(!s||s.password!==t)return null;const n={id:o,username:o,role:s.role,permissions:b.roles[s.role],exp:Date.now()+b.tokenExpiry,iat:Date.now()};return this.encode(n)}static verifyToken(o){try{const t=this.decode(o);if(t.exp<Date.now())throw new Error("Token expired");return{id:t.id,username:t.username,role:t.role,permissions:t.permissions}}catch{return null}}static hasPermission(o,t){return o.permissions.includes(t)}static refreshToken(o){const t=this.verifyToken(o);if(!t)return null;const s={id:t.id,username:t.username,role:t.role,permissions:t.permissions,exp:Date.now()+b.tokenExpiry,iat:Date.now()};return this.encode(s)}}const h={TOKEN:"mybonzo_admin_token",USER:"mybonzo_admin_user",LAST_ACTIVITY:"mybonzo_last_activity"};function O(){const[r,o]=l.useState(!1),[t,s]=l.useState(null),[n,a]=l.useState(""),[c,i]=l.useState(""),[f,d]=l.useState(""),[p,x]=l.useState(!1);l.useEffect(()=>{const u=localStorage.getItem(h.TOKEN);if(u){const m=S.verifyToken(u);m?(s(m),o(!0),localStorage.setItem(h.LAST_ACTIVITY,Date.now().toString())):(localStorage.removeItem(h.TOKEN),localStorage.removeItem(h.USER))}},[]);const j=async()=>{if(!n.trim()||!c.trim()){d("Wprowadź nazwę użytkownika i hasło!");return}x(!0),d("");try{const u=S.authenticate(n,c);if(u){const m=S.verifyToken(u);m&&(s(m),o(!0),localStorage.setItem(h.TOKEN,u),localStorage.setItem(h.USER,JSON.stringify(m)),localStorage.setItem(h.LAST_ACTIVITY,Date.now().toString()),console.log(`Login successful! Welcome ${m.username} (${m.role})`))}else d("Niepoprawne dane logowania!"),i("")}catch(u){console.error("Login error:",u),d("Błąd podczas logowania. Spróbuj ponownie.")}finally{x(!1)}},v=()=>{confirm("Czy na pewno chcesz się wylogować?")&&(o(!1),s(null),a(""),i(""),localStorage.removeItem(h.TOKEN),localStorage.removeItem(h.USER),localStorage.removeItem(h.LAST_ACTIVITY))},k=u=>{u.key==="Enter"&&!p&&j()};l.useEffect(()=>{if(r){const u=setInterval(()=>{const m=localStorage.getItem(h.TOKEN);m&&(S.verifyToken(m)||v())},6e4);return()=>clearInterval(u)}},[r]);const g={container:{minHeight:"100vh",background:`
        linear-gradient(rgba(0, 215, 239, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 215, 239, 0.1) 1px, transparent 1px),
        linear-gradient(rgba(0, 215, 239, 0.05) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 215, 239, 0.05) 1px, transparent 1px),
        #000000
      `,backgroundSize:"100px 100px, 100px 100px, 20px 20px, 20px 20px",color:"#00e7ff",fontFamily:'"Segoe UI", Tahoma, Geneva, Verdana, sans-serif',padding:"2rem"},loginScreen:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",minHeight:"100vh",textAlign:"center"},loginBox:{background:"rgba(0, 0, 0, 0.6)",border:"2px solid #00d7ef",borderRadius:"0px",padding:"2rem",backdropFilter:"blur(10px)",boxShadow:"0 0 30px rgba(0, 215, 239, 0.5)",minWidth:"300px"},loginTitle:{color:"#00e7ff",fontSize:"2rem",marginBottom:"2rem",textShadow:"0 0 10px rgba(0, 231, 255, 0.5)"},inputGroup:{marginBottom:"1.5rem"},label:{display:"block",marginBottom:"0.5rem",color:"#00e7ff",fontWeight:600},input:{width:"100%",padding:"0.75rem",background:"rgba(0, 0, 0, 0.6)",border:"2px solid #00d7ef",borderRadius:"0px",color:"#00e7ff",fontSize:"1rem",outline:"none"},button:{background:"linear-gradient(45deg, #00e7ff, #0099cc)",border:"none",borderRadius:"0px",padding:"0.75rem 2rem",color:"#000",fontWeight:600,cursor:"pointer",fontSize:"1rem",transition:"all 0.3s ease"},error:{color:"#00d7ef",background:"rgba(0, 0, 0, 0.6)",border:"2px solid #00d7ef",borderRadius:"0px",padding:"0.5rem",margin:"0.5rem 0"}};return r?e.jsx("div",{style:g.container,children:e.jsx(T,{user:t,onLogout:v})}):e.jsx("div",{style:g.container,children:e.jsx("div",{style:g.loginScreen,children:e.jsxs("div",{style:g.loginBox,children:[e.jsx("h1",{style:g.loginTitle,children:"Panel Administracyjny"}),e.jsxs("div",{style:g.inputGroup,children:[e.jsx("label",{htmlFor:"username",style:g.label,children:"Nazwa użytkownika:"}),e.jsx("input",{type:"text",id:"username",value:n,onChange:u=>a(u.target.value),onKeyPress:k,style:g.input,placeholder:"Wprowadź login...",autoComplete:"username",disabled:p})]}),e.jsxs("div",{style:g.inputGroup,children:[e.jsx("label",{htmlFor:"password",style:g.label,children:"Hasło:"}),e.jsx("input",{type:"password",id:"password",value:c,onChange:u=>i(u.target.value),onKeyPress:k,style:g.input,placeholder:"Wprowadź hasło...",autoComplete:"current-password",disabled:p})]}),e.jsx("button",{onClick:j,style:{...g.button,opacity:p?.6:1,cursor:p?"not-allowed":"pointer"},disabled:p,children:p?"Logowanie...":"Zaloguj się"}),f&&e.jsx("div",{style:g.error,children:f}),e.jsxs("div",{style:{...g.error,borderColor:"#00e7ff",color:"#00e7ff",fontSize:"0.8rem",marginTop:"1rem"},children:[e.jsx("strong",{children:"Demo Accounts:"}),e.jsx("br",{}),"Admin: admin / HAOS77",e.jsx("br",{}),"Moderator: moderator / MOD2025",e.jsx("br",{}),"Viewer: viewer / VIEW2025"]})]})})})}function T({user:r,onLogout:o}){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.6)",border:"2px solid #00d7ef",borderRadius:"0px",padding:"2rem",marginBottom:"2rem",fontStyle:"italic",color:"#ffd700",textAlign:"center",backdropFilter:"blur(5px)",fontSize:"1.8rem",fontWeight:600,lineHeight:"1.4"},children:[`"I've seen things you people wouldn't believe. Attack ships on fire off the shoulder of Orion. I watched C-beams glitter in the dark near the Tannhäuser Gate. All those moments will be lost in time, like tears in rain."`,e.jsx("br",{}),e.jsx("em",{children:"- Blade Runner"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("h1",{style:{color:"#00e7ff",fontSize:"2.5rem",textShadow:"0 0 15px rgba(0, 231, 255, 0.7)"},children:"MyBonzo Admin Panel"}),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.6)",border:"2px solid #00d7ef",padding:"1rem",borderRadius:"0px",color:"#00e7ff"},children:[e.jsxs("div",{style:{fontSize:"0.9rem"},children:["Logged in as: ",e.jsx("strong",{children:r?.username})]}),e.jsxs("div",{style:{fontSize:"0.8rem",opacity:.8},children:["Role: ",r?.role?.toUpperCase()," | Permissions: ",r?.permissions?.length||0]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:"2rem",marginTop:"2rem"},children:[e.jsx(A,{}),e.jsx(E,{}),e.jsx(I,{}),e.jsx(B,{}),e.jsx(C,{})]}),e.jsx("button",{onClick:o,style:{position:"fixed",bottom:"2rem",right:"2rem",background:"linear-gradient(45deg, #00d7ef, #1ec7d3)",border:"none",borderRadius:"0px",padding:"0.75rem 2rem",color:"#000",fontWeight:600,cursor:"pointer",fontSize:"1rem",zIndex:1e3},children:"Wyloguj się"})]})}function A(){const[r,o]=l.useState({visitors:0,queries:0,uptime:"0:00:00",responseTime:0,storage:0,bandwidth:0}),[t,s]=l.useState(!0);l.useEffect(()=>{const a=async()=>{try{const i=await fetch("/api/admin/stats",{headers:{Authorization:"Bearer HAOS77"}});if(i.ok){const f=await i.json();o(f)}}catch(i){console.error("Error fetching stats:",i)}finally{s(!1)}};a();const c=setInterval(a,3e4);return()=>clearInterval(c)},[]);const n={background:"rgba(0, 0, 0, 0.8)",border:"2px solid #00e7ff",borderRadius:"0px",padding:"20px",color:"#00e7ff",fontFamily:"monospace"};return t?e.jsx("div",{style:n,children:"Loading stats..."}):e.jsxs("div",{style:n,children:[e.jsx("h3",{style:{marginBottom:"20px",textAlign:"center",textTransform:"uppercase",letterSpacing:"2px",color:"#00e7ff"},children:"📊 SYSTEM STATISTICS"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"15px"},children:[e.jsx(y,{label:"VISITORS",value:r.visitors.toLocaleString()}),e.jsx(y,{label:"AI QUERIES",value:r.queries.toLocaleString()}),e.jsx(y,{label:"UPTIME",value:r.uptime}),e.jsx(y,{label:"RESPONSE TIME",value:r.responseTime+"ms"}),e.jsx(y,{label:"STORAGE",value:r.storage+"GB"}),e.jsx(y,{label:"BANDWIDTH",value:r.bandwidth+"GB"})]})]})}function y({label:r,value:o}){return e.jsxs("div",{style:{background:"#000",border:"1px solid #00e7ff",padding:"15px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"18px",fontWeight:"bold"},children:o}),e.jsx("div",{style:{fontSize:"11px",marginTop:"5px"},children:r})]})}function E(){const[r,o]=l.useState({services:[],system:{}}),[t,s]=l.useState(!0);l.useEffect(()=>{const a=async()=>{try{const i=await fetch("/api/admin/status",{headers:{Authorization:"Bearer HAOS77"}});if(i.ok){const f=await i.json();o(f)}}catch(i){console.error("Error fetching status:",i)}finally{s(!1)}};a();const c=setInterval(a,3e4);return()=>clearInterval(c)},[]);const n={background:"rgba(0, 0, 0, 0.8)",border:"2px solid #00e7ff",borderRadius:"0px",padding:"20px",color:"#00e7ff",fontFamily:"monospace"};return t?e.jsx("div",{style:n,children:"Loading system status..."}):e.jsxs("div",{style:n,children:[e.jsx("h3",{style:{marginBottom:"20px",textAlign:"center",textTransform:"uppercase",letterSpacing:"2px"},children:"⚡ SYSTEM STATUS"}),e.jsxs("div",{style:{marginBottom:"20px"},children:[e.jsx("h4",{style:{marginBottom:"10px",color:"#00e7ff"},children:"Services:"}),r.services.length===0?e.jsx("div",{style:{textAlign:"center",color:"#666"},children:"No services data"}):r.services.map((a,c)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#000",border:"1px solid #333",marginBottom:"5px"},children:[e.jsx("span",{children:a.name}),e.jsxs("span",{style:{color:a.status==="online"?"#00ff00":a.status==="degraded"?"#ffff00":"#ff0000"},children:[a.status.toUpperCase(),a.responseTime&&` (${a.responseTime}ms)`]})]},c))]})]})}function I(){const[r,o]=l.useState(null),[t,s]=l.useState(!0);l.useEffect(()=>{const a=async()=>{try{const i=await fetch("/api/admin/analytics",{headers:{Authorization:"Bearer HAOS77"}});if(i.ok){const f=await i.json();o(f)}}catch(i){console.error("Error fetching analytics:",i)}finally{s(!1)}};a();const c=setInterval(a,3e5);return()=>clearInterval(c)},[]);const n={background:"rgba(0, 0, 0, 0.8)",border:"2px solid #00e7ff",borderRadius:"0px",padding:"20px",color:"#00e7ff",fontFamily:"monospace"};return t?e.jsx("div",{style:n,children:"📈 Loading analytics..."}):r?e.jsxs("div",{style:n,children:[e.jsx("h3",{style:{marginBottom:"20px",textAlign:"center",textTransform:"uppercase",letterSpacing:"2px"},children:"📈 TRAFFIC ANALYTICS"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))",gap:"15px",marginBottom:"20px"},children:[e.jsx(y,{label:"REAL-TIME USERS",value:r.realTimeUsers}),e.jsx(y,{label:"TOTAL SESSIONS",value:r.totalSessions.toLocaleString()}),e.jsx(y,{label:"BOUNCE RATE",value:r.bounceRate+"%"}),e.jsx(y,{label:"AVG SESSION",value:Math.floor(r.avgSessionDuration/60)+"m"})]})]}):e.jsx("div",{style:{...n,borderColor:"#ff9900",color:"#ff9900"},children:"📈 Analytics data unavailable"})}function C(){const[r,o]=l.useState([]),[t,s]=l.useState(!1),[n,a]=l.useState(""),c=async()=>{s(!0);try{const d=await fetch("/api/admin/workers-status",{headers:{Authorization:"Bearer HAOS77"}});if(d.ok){const p=await d.json();o(p.workers||[]),a(new Date().toLocaleTimeString())}}catch(d){console.error("Error fetching workers status:",d)}finally{s(!1)}};l.useEffect(()=>{c()},[]);const i=r.filter(d=>d.status==="online").length,f=r.length;return e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",border:"2px solid #00e7ff",borderRadius:"0px",padding:"20px",color:"#00e7ff",fontFamily:"monospace"},children:[e.jsx("h3",{style:{marginBottom:"20px",textAlign:"center",textTransform:"uppercase",letterSpacing:"2px"},children:"🔧 WORKERS STATUS"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px",padding:"10px",background:"#111",border:"1px solid #333"},children:[e.jsxs("span",{children:["Online: ",i,"/",f]}),e.jsxs("span",{children:["Last: ",n]}),e.jsx("button",{onClick:c,disabled:t,style:{background:"#00e7ff",color:"#000",border:"none",padding:"5px 10px",cursor:"pointer"},children:t?"Loading...":"Refresh"})]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:r.map((d,p)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px",background:"#000",border:"1px solid #333",marginBottom:"5px"},children:[e.jsx("span",{children:d.name}),e.jsxs("span",{style:{color:d.status==="online"?"#00ff00":d.status==="partial"?"#ffff00":"#ff0000"},children:[d.status.toUpperCase(),d.responseMs?` (${d.responseMs}ms)`:""]})]},p))})]})}function B(){const[r,o]=l.useState([]),[t,s]=l.useState(!1),[n,a]=l.useState(""),[c,i]=l.useState(""),f=async()=>{s(!0);try{const p=await fetch("/api/admin/backup",{headers:{Authorization:"Bearer "+localStorage.getItem("mybonzo_admin_token")}});if(p.ok){const x=await p.json();o(x.backups||[]),a(new Date().toLocaleTimeString())}}catch(p){console.error("Error fetching backups:",p),i("Error loading backups")}finally{s(!1)}},d=async(p="manual")=>{s(!0),i("");try{const x=await fetch("/api/admin/backup",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("mybonzo_admin_token")},body:JSON.stringify({action:"create",reason:p})});if(x.ok){const j=await x.json();i("✅ Backup created successfully!"),f()}else i("❌ Failed to create backup")}catch(x){console.error("Error creating backup:",x),i("❌ Error creating backup")}finally{s(!1)}};return l.useEffect(()=>{f()},[]),e.jsxs("div",{style:{background:"rgba(0, 0, 0, 0.8)",border:"2px solid #00e7ff",borderRadius:"0px",padding:"20px",color:"#00e7ff",fontFamily:"monospace"},children:[e.jsx("h3",{style:{marginBottom:"20px",textAlign:"center",textTransform:"uppercase",letterSpacing:"2px"},children:"💾 BACKUP MANAGER"}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"20px",padding:"10px",background:"#111",border:"1px solid #333"},children:[e.jsxs("span",{children:["Backups: ",r.length,"/5"]}),e.jsxs("span",{children:["Last: ",n]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>d("manual"),disabled:t,style:{background:"#00e7ff",color:"#000",border:"none",padding:"5px 10px",cursor:"pointer",marginRight:"5px"},children:t?"Creating...":"Create Backup"}),e.jsx("button",{onClick:f,disabled:t,style:{background:"#00e7ff",color:"#000",border:"none",padding:"5px 10px",cursor:"pointer"},children:"Refresh"})]})]}),c&&e.jsx("div",{style:{padding:"10px",background:c.includes("✅")?"#003300":"#330000",border:`1px solid ${c.includes("✅")?"#00ff00":"#ff0000"}`,marginBottom:"10px",color:c.includes("✅")?"#00ff00":"#ff6666"},children:c}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:r.length===0?e.jsx("div",{style:{textAlign:"center",color:"#666",padding:"20px"},children:"No backups found"}):r.map((p,x)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",background:"#000",border:"1px solid #333",marginBottom:"5px"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:"0.9rem"},children:p.name}),e.jsx("div",{style:{fontSize:"0.7rem",opacity:.7},children:new Date(p.date).toLocaleString()})]}),e.jsx("div",{style:{fontSize:"0.8rem",color:"#00ff00"},children:p.age||"Active"})]},x))}),e.jsxs("div",{style:{marginTop:"15px",display:"flex",gap:"5px",flexWrap:"wrap"},children:[e.jsx("button",{onClick:()=>d("before_deploy"),disabled:t,style:{background:"#ff9900",color:"#000",border:"none",padding:"5px 10px",cursor:"pointer",fontSize:"0.8rem"},children:"Pre-Deploy"}),e.jsx("button",{onClick:()=>d("feature_update"),disabled:t,style:{background:"#9900ff",color:"#fff",border:"none",padding:"5px 10px",cursor:"pointer",fontSize:"0.8rem"},children:"Feature Update"}),e.jsx("button",{onClick:()=>d("config_change"),disabled:t,style:{background:"#00ff99",color:"#000",border:"none",padding:"5px 10px",cursor:"pointer",fontSize:"0.8rem"},children:"Config Change"})]})]})}export{O as default};
