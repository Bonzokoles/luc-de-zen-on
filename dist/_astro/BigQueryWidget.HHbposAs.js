import"./disclose-version.DsnmJJEf.js";import"./legacy.kkaBD5aU.js";import{c as $e}from"./index-client.CI4zVHyS.js";import{p as De,f as d,s as n,c as s,t as w,g as e,a as h,h as v,b as l,d as Fe,r as t,e as He,j as Je,q as A,k as G,w as Ke,x as Ae}from"./template.BqTI6ysn.js";import{s as o,e as k}from"./render.DLtPj5hE.js";import{i as x}from"./if.CL3_9eW_.js";import{e as re,i as ie}from"./each.BgQDu70D.js";import{a as Ge}from"./attributes.CMoobVFc.js";import{s as Me}from"./class.Cwo7PGLY.js";import{b as Ze}from"./input.BDyfk_mK.js";import{i as Ie}from"./lifecycle.CZxN27Pe.js";/* empty css                                   */import"./index.DIeogL5L.js";import"./attributes.BJtm3mOD.js";var Ue=d('<div class="error-message svelte-qinsj6"><div class="error-icon svelte-qinsj6">‚ö†Ô∏è</div> <p class="svelte-qinsj6"> </p></div>'),Ve=d('<div class="data-cell svelte-qinsj6"><strong> </strong> </div>'),Xe=d('<div class="data-cell svelte-qinsj6"> </div>'),Ye=d('<div class="data-row svelte-qinsj6"><!></div>'),es=d("<p>Brak danych do wy≈õwietlenia</p>"),ss=d('<div class="results-display svelte-qinsj6"><div class="query-info svelte-qinsj6"><strong>Query:</strong> </div> <div class="metadata svelte-qinsj6"><span> </span> <span> </span> <span> </span></div> <div class="data-grid svelte-qinsj6"><!></div></div>'),ts=d('<div class="results-container svelte-qinsj6"><!> <div class="actions svelte-qinsj6"><button class="clear-btn svelte-qinsj6" title="Wyczy≈õƒá wyniki">üóëÔ∏è</button></div></div>'),as=d('<span class="spinner svelte-qinsj6"></span>'),rs=d('<div><div class="widget-header svelte-qinsj6"><div class="title-section svelte-qinsj6"><h3 class="svelte-qinsj6">üìä BigQuery Analytics</h3> <span class="service-badge svelte-qinsj6">Google Cloud</span></div> <div class="header-actions svelte-qinsj6"><button class="expand-btn svelte-qinsj6" title="Rozwi≈Ñ/Zwi≈Ñ"> </button> <button class="full-btn svelte-qinsj6" title="Otw√≥rz pe≈ÇnƒÖ analitykƒô">üîó</button></div></div> <div class="widget-content svelte-qinsj6"><!> <div class="input-section svelte-qinsj6"><div class="input-container svelte-qinsj6"><textarea placeholder="SELECT * FROM dataset.table WHERE..." class="sql-input svelte-qinsj6"></textarea> <button class="execute-btn svelte-qinsj6" title="Wykonaj zapytanie SQL"><!></button></div></div></div></div>');function bs(ne,le){De(le,!1);const ve=$e();let u=h(""),i=h(null),p=h(!1),_=h(null),f=h(!1);async function M(){if(!e(u).trim()||e(p))return;const a=e(u).trim();v(u,""),v(p,!0),v(_,null);try{const r=await fetch("/api/bigquery",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a,dataset:"analytics"})});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const c=await r.json();if(c.status==="success")v(i,c),ve("queryExecuted",{results:c});else throw new Error(c.message||"Nie uda≈Ço siƒô wykonaƒá zapytania")}catch(r){v(_,r.message),v(i,null),console.error("BigQuery error:",r)}finally{v(p,!1)}}function oe(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),M())}function de(){v(f,!e(f))}function ce(){window.open("/bigquery-analytics","_blank")}function ue(){v(i,null),v(_,null)}Ie();var E=rs();let Z;var R=s(E),I=n(s(R),2),T=s(I),pe=s(T,!0);t(T);var _e=n(T,2);t(I),t(R);var U=n(R,2),V=s(U);{var fe=a=>{var r=ts(),c=s(r);{var be=y=>{var q=Ue(),O=n(s(q),2),z=s(O,!0);t(O),t(q),w(()=>o(z,e(_))),l(y,q)},ge=y=>{var q=A(),O=G(q);{var z=B=>{var S=ss(),C=s(S),xe=n(s(C));t(C);var W=n(C,2),L=s(W),we=s(L);t(L);var N=n(L,2),he=s(N);t(N);var se=n(N,2),ke=s(se);t(se),t(W);var te=n(W,2),Ee=s(te);{var Te=b=>{var P=A(),Oe=G(P);re(Oe,1,()=>e(i).results?.rows||e(i).results,ie,(Pe,$)=>{var D=Ye(),Re=s(D);{var ze=g=>{var j=A(),F=G(j);re(F,1,()=>Object.entries(e($)),ie,(H,Se)=>{var ae=Ke(()=>Ae(e(Se),2));let Ce=()=>e(ae)[0],We=()=>e(ae)[1];var J=Ve(),K=s(J),Le=s(K);t(K);var Ne=n(K);t(J),w(()=>{o(Le,`${Ce()??""}:`),o(Ne,` ${We()??""}`)}),l(H,J)}),l(g,j)},Be=g=>{var j=Xe(),F=s(j,!0);t(j),w(H=>o(F,H),[()=>JSON.stringify(e($))]),l(g,j)};x(Re,g=>{typeof e($)=="object"?g(ze):g(Be,!1)})}t(D),l(Pe,D)}),l(b,P)},Qe=b=>{var P=es();l(b,P)};x(Ee,b=>{e(i).results?.rows||e(i).results?b(Te):b(Qe,!1)})}t(te),t(S),w(()=>{o(xe,` ${e(i).query??""}`),o(we,`Rows: ${(e(i).metadata?.totalRows||e(i).rowCount)??""}`),o(he,`Time: ${(e(i).metadata?.executionTime||e(i).executionTime)??""}`),o(ke,`Processed: ${(e(i).metadata?.bytesProcessed||e(i).bytesProcessed)??""}`)}),l(B,S)};x(O,B=>{e(i)&&B(z)},!0)}l(y,q)};x(c,y=>{e(_)?y(be):y(ge,!1)})}var ee=n(c,2),je=s(ee);t(ee),t(r),k("click",je,ue),l(a,r)};x(V,a=>{e(f)&&(e(i)||e(_))&&a(fe)})}var X=n(V,2),Y=s(X),m=s(Y);He(m);var Q=n(m,2),me=s(Q);{var ye=a=>{var r=as();l(a,r)},qe=a=>{var r=Je("üìä");l(a,r)};x(me,a=>{e(p)?a(ye):a(qe,!1)})}t(Q),t(Y),t(X),t(U),t(E),w((a,r)=>{Z=Me(E,1,"bigquery-widget svelte-qinsj6",null,Z,a),o(pe,e(f)?"‚ñº":"‚ñ≤"),Ge(m,"rows",e(f)?"3":"2"),m.disabled=e(p),Q.disabled=r},[()=>({expanded:e(f)}),()=>!e(u).trim()||e(p)]),k("click",T,de),k("click",_e,ce),Ze(m,()=>e(u),a=>v(u,a)),k("keypress",m,oe),k("click",Q,M),l(ne,E),Fe()}export{bs as default};
