import{p as Re,H as Be,g as e,d as g,v as c,m as w,i as Le,f as B,T as Oe,c as l,s as u,I as W,a as me,t as ge,x as I,z as we,U as Fe,F as Ke,h as f,j as U,k as Xe,n as i,l as je,G as qe,y as He,A as Ve,B as Ye}from"./ClientRouter.astro_astro_type_script_index_0_lang.DtH6aRN_.js";/* empty css                       */import"./react.BKEw5ZbO.js";if(typeof MessageChannel>"u"){class x{constructor(){this.onmessage=null}postMessage(d){const o={data:d};(typeof queueMicrotask=="function"?queueMicrotask:b=>setTimeout(b,0))(()=>this.onmessage&&this.onmessage(o))}start(){}close(){}}class L{constructor(){this.port1=new x,this.port2=new x;const d=(o,b)=>{const n={data:b};(typeof queueMicrotask=="function"?queueMicrotask:r=>setTimeout(r,0))(()=>o.onmessage&&o.onmessage(n))};this.port1.postMessage=o=>d(this.port2,o),this.port2.postMessage=o=>d(this.port1,o)}}globalThis.MessageChannel=L}var Ze=B('<div class="playlist-empty svelte-u12wbg">Brak załadowanych utworów</div>'),Ge=B('<button><span class="track-number svelte-u12wbg"></span> <span class="track-title svelte-u12wbg"> </span></button>'),We=B('<div class="inline-playlist-panel svelte-u12wbg"><div class="playlist-header-inline svelte-u12wbg"><span>🎵 BIBLIOTEKA MUZYKI</span></div> <div class="playlist-content-inline svelte-u12wbg"><!></div> <div class="playlist-actions-inline svelte-u12wbg"><input type="file" webkitdirectory multiple accept="audio/*,video/mp4,.mp3,.mp4,.wav,.ogg,.m4a,.aac,.flac,.wma,.opus,.webm,.3gp" style="display: none;" id="music-folder"/> <button class="action-btn-inline svelte-u12wbg">📁 Folder</button> <button class="action-btn-inline svelte-u12wbg">🎵 Demo</button></div></div>'),Je=B('<div class="background-music-player in-flow svelte-u12wbg"><audio preload="metadata" crossorigin="anonymous"></audio> <div class="music-control-panel svelte-u12wbg"><div class="panel-header svelte-u12wbg"><span>🎵 MUSIC • POLACZEK</span></div> <div class="panel-content svelte-u12wbg"><div class="now-playing svelte-u12wbg"><div class="track-info svelte-u12wbg"><div class="track-name svelte-u12wbg"> </div> <div class="track-time svelte-u12wbg"> </div></div></div> <div class="player-controls svelte-u12wbg"><button class="control-btn svelte-u12wbg">⏮</button> <button class="control-btn play-pause svelte-u12wbg"> </button> <button class="control-btn svelte-u12wbg">⏭</button> <button> </button></div> <div class="volume-control svelte-u12wbg"><span class="svelte-u12wbg">🔊</span> <input type="range" min="0" max="100" class="volume-slider svelte-u12wbg"/></div> <div class="progress-container svelte-u12wbg"><div class="progress-bar svelte-u12wbg" role="slider" tabindex="0" aria-label="Seek"><div class="progress-fill svelte-u12wbg"></div></div></div> <!></div></div></div>');function at(x,L){Re(L,!1);let a=g(),d,o,b,n=g([]),r=g(0),h=g(!1),y=g(.5),E=g(0),m=g(0),_=g(!1),O=g("No track selected");Be(()=>{D(),typeof window<"u"&&(delete window.MUSIC,window.MUSIC={play:()=>{e(h)||N()},pause:()=>{e(h)&&N()},toggle:()=>N(),next:()=>K(),prev:()=>Q(),togglePlaylist:()=>te(),setVolume:t=>{const s=Math.max(0,Math.min(1,Number(t)));c(y,s),e(a)&&w(a,e(a).volume=e(y))},getState:()=>({isPlaying:e(h),trackName:e(O),volume:e(y)}),ensureLoaded:()=>{e(n).length?C():D()},getAnalyser:()=>o||window.MUSIC_ANALYSER||null,openFolderPicker:()=>{console.log("🎵 Opening music library folder picker...");try{const t=document.getElementById("music-folder");t&&typeof t.click=="function"?(t.click(),console.log("✅ Music library folder picker opened successfully")):(console.warn("❌ Music folder picker element not found"),alert("Błąd: Nie można otworzyć selektora folderów z muzyką"))}catch(t){console.warn("Folder picker not available:",t),alert("Błąd: Selektor folderów niedostępny - "+t.message)}}},console.log("🎵 MUSIC API registered and ready"))});function J(){try{if(!e(a)||o)return;const t=window.AudioContext||window.webkitAudioContext;if(!t)return;d=window.MUSIC_AUDIO_CTX||new t,d.state==="suspended"&&d.resume().catch(()=>{}),window.MUSIC_MEDIA_SOURCE?b=window.MUSIC_MEDIA_SOURCE:(b=d.createMediaElementSource(e(a)),window.MUSIC_MEDIA_SOURCE=b),o=window.MUSIC_ANALYSER||d.createAnalyser(),o.fftSize=1024,o.smoothingTimeConstant=.85;try{b.connect(o),o.connect(d.destination)}catch{}window.MUSIC_AUDIO_CTX=d,window.MUSIC_ANALYSER=o,window.dispatchEvent(new CustomEvent("music-analyser-ready"));try{const s=window.MIC_AUDIO_CTX;s&&s.state==="suspended"&&s.resume().catch(()=>{})}catch{}}catch(t){console.warn("setupAnalyser failed",t)}}function D(){c(n,[{name:"MERKABA",url:"https://assets.codepen.io/7558/Merkaba.mp3"},{name:"DHAMIKA",url:"https://assets.codepen.io/7558/Dhamika.mp3"},{name:"VACANT",url:"https://assets.codepen.io/7558/Vacant.mp3"},{name:"LXSTNGHT",url:"https://assets.codepen.io/7558/lxstnght-back_1.mp3"}]),C()}function C(){e(n)[e(r)]&&(c(O,e(n)[e(r)].name),e(a)&&e(n)[e(r)].url&&(w(a,e(a).src=e(n)[e(r)].url),w(a,e(a).volume=e(y)),J()))}function N(){if(!e(n)[e(r)]){D();return}e(a).src||C(),e(h)?(e(a).pause(),c(h,!1)):(J(),e(a).play().then(()=>{c(h,!0);try{d&&d.state==="suspended"&&d.resume()}catch{}}).catch(console.error))}function F(t){t>=0&&t<e(n).length&&(c(r,t),C(),e(h)&&e(a).play())}function Q(){e(n).length>0&&(c(r,(e(r)-1+e(n).length)%e(n).length),F(e(r)))}function K(){e(n).length>0&&(c(r,(e(r)+1)%e(n).length),F(e(r)))}function be(){e(a)&&(c(E,e(a).currentTime),c(m,e(a).duration||0))}function he(){K()}function ye(t){c(y,t.target.value/100),e(a)&&w(a,e(a).volume=e(y))}function ke(t){if(e(a)&&e(m)){const s=t.currentTarget.getBoundingClientRect(),p=(t.clientX-s.left)/s.width;w(a,e(a).currentTime=p*e(m))}}function _e(t){if(!e(a)||!e(m))return;const s=5;t.key==="ArrowRight"?(w(a,e(a).currentTime=Math.min(e(m),e(a).currentTime+s)),t.preventDefault()):t.key==="ArrowLeft"?(w(a,e(a).currentTime=Math.max(0,e(a).currentTime-s)),t.preventDefault()):t.key==="Home"?(w(a,e(a).currentTime=0),t.preventDefault()):t.key==="End"?(w(a,e(a).currentTime=e(m)),t.preventDefault()):(t.key==="Enter"||t.key===" ")&&t.preventDefault()}function ee(t){const s=Math.floor(t/60),p=Math.floor(t%60);return`${s}:${p.toString().padStart(2,"0")}`}function Me(t){try{if(console.log("📁 Processing selected files..."),!t.target.files||t.target.files.length===0){console.warn("❌ No files selected"),alert("⚠️ Nie wybrano żadnych plików");return}const s=Array.from(t.target.files);console.log(`📁 Total files found: ${s.length}`);const p=s.filter(v=>{const S=v.type.startsWith("audio/")||/\.(mp3|mp4|wav|ogg|m4a|aac|flac|wma|opus|webm|3gp|amr|ape|dts|ac3|mka|mpc|ra|tta|wv|au|aiff|snd|voc|8svx|iff|nist|sphere|vox|w64|mat|pvf|fap|caf|sd2|irca|w64|mat|bwf|rf64)$/i.test(v.name);return S||console.log(`⚠️ Skipping non-audio file: ${v.name} (${v.type})`),S});if(console.log(`🎵 Audio files found: ${p.length}`),p.length===0){alert("❌ Nie znaleziono plików audio w wybranej lokalizacji");return}if(c(n,p.map((v,S)=>{try{const A=URL.createObjectURL(v);return console.log(`✅ Created URL for: ${v.name}`),{name:v.name.replace(/\.[^/.]+$/,""),file:v,url:A,size:v.size,source:"local"}}catch(A){return console.error(`❌ Failed to create URL for ${v.name}:`,A),null}}).filter(v=>v!==null)),e(n).length===0){alert("❌ Nie udało się załadować żadnego pliku audio");return}c(r,0),C(),c(_,!0),console.log(`✅ Successfully loaded ${e(n).length} tracks`),alert(`🎵 Załadowano ${e(n).length} utworów z lokalnych plików!`),t.target.value=""}catch(s){console.error("❌ Error in handleFolderSelect:",s),alert(`❌ Błąd ładowania plików: ${s.message}`)}}function te(){c(_,!e(_))}Le();var X=Je(),$=l(X);Oe($,t=>c(a,t),()=>e(a));var ae=u($,2),se=u(l(ae),2),j=l(se),ne=l(j),q=l(ne),Ce=l(q,!0);i(q);var le=u(q,2),Se=l(le);i(le),i(ne),i(j);var H=u(j,2),ie=l(H),z=u(ie,2),Ae=l(z,!0);i(z);var oe=u(z,2),P=u(oe,2);let re;var Te=l(P,!0);i(P),i(H);var V=u(H,2),Y=u(l(V),2);je(Y),i(V);var Z=u(V,2),k=l(Z);W(k,"aria-valuemin",0);var Ie=l(k);i(k),i(Z);var Ue=u(Z,2);{var xe=t=>{var s=We(),p=u(l(s),2),v=l(p);{var S=M=>{var R=Ze();U(M,R)},A=M=>{var R=qe(),De=He(R);Ve(De,1,()=>e(n),Ye,(Ne,$e,G)=>{var T=Ge();let ve;var pe=l(T);pe.textContent=G+1;var fe=u(pe,2),ze=l(fe,!0);i(fe),i(T),ge(Pe=>{ve=we(T,1,"playlist-item-inline svelte-u12wbg",null,ve,Pe),I(ze,e($e).name)},[()=>({active:G===e(r)})]),f("click",T,()=>F(G)),U(Ne,T)}),U(M,R)};me(v,M=>{e(n).length===0?M(S):M(A,!1)})}i(p);var ce=u(p,2),ue=l(ce),de=u(ue,2),Ee=u(de,2);i(ce),i(s),f("change",ue,Me),f("click",de,()=>document.getElementById("music-folder").click()),f("click",Ee,D),U(t,s)};me(Ue,t=>{e(_)&&t(xe)})}i(se),i(ae),i(X),ge((t,s,p)=>{I(Ce,e(O)),I(Se,`${t??""} / ${s??""}`),I(Ae,e(h)?"⏸":"▶"),re=we(P,1,"control-btn svelte-u12wbg",null,re,p),I(Te,e(_)?"📋✓":"📋"),Fe(Y,e(y)*100),W(k,"aria-valuemax",e(m)||0),W(k,"aria-valuenow",e(E)||0),Ke(Ie,`width: ${e(m)?e(E)/e(m)*100:0}%`)},[()=>ee(e(E)),()=>ee(e(m)),()=>({active:e(_)})]),f("timeupdate",$,be),f("ended",$,he),f("click",ie,Q),f("click",z,N),f("click",oe,K),f("click",P,te),f("input",Y,ye),f("click",k,ke),f("keydown",k,_e),U(x,X),Xe()}export{at as default};
