import{r as g,j as L}from"./react.0nTXIzv_.js";import"./Header.astro_astro_type_script_index_0_lang.C3v9REYp.js";if(typeof MessageChannel>"u"){class a{constructor(){this.onmessage=null}postMessage(r){const t={data:r};(typeof queueMicrotask=="function"?queueMicrotask:i=>setTimeout(i,0))(()=>this.onmessage&&this.onmessage(t))}start(){}close(){}}class d{constructor(){this.port1=new a,this.port2=new a;const r=(t,i)=>{const p={data:i};(typeof queueMicrotask=="function"?queueMicrotask:s=>setTimeout(s,0))(()=>t.onmessage&&t.onmessage(p))};this.port1.postMessage=t=>r(this.port2,t),this.port2.postMessage=t=>r(this.port1,t)}}globalThis.MessageChannel=d}function P({height:a=120,source:d="auto",variant:f="edge"}){const r=g.useRef(null),t=g.useRef(null),i=g.useRef(null),p=g.useRef(null);return g.useEffect(()=>{const s=r.current;if(!s)return;const o=s.getContext("2d");if(!o)return;const c=Math.max(1,window.devicePixelRatio||1),A=()=>{const e=s.getBoundingClientRect();s.width=Math.floor(e.width*c),s.height=Math.floor(a*c)};A();let v=0;function k(){const e=window,n=e.MUSIC_ANALYSER||e.MUSIC&&e.MUSIC.getAnalyser&&e.MUSIC.getAnalyser(),l=e.MIC_ANALYSER||null;return d==="music"?n:d==="mic"?l:n||l}function h(){try{const e=k();e&&e.frequencyBinCount&&(i.current=e,p.current=new Uint8Array(e.frequencyBinCount))}catch{}}h(),window.addEventListener("music-analyser-ready",h),window.addEventListener("mic-analyser-ready",h);const E=()=>{t.current=requestAnimationFrame(E),v+=.015;const e=s.width,n=s.height;o.clearRect(0,0,e,n);const l=Math.max(24,Math.floor(e/(18*c))),b=e/l,q=getComputedStyle(document.documentElement).getPropertyValue("--color-edge")?.trim()||"hsl(200,30%,18%)";let M="#00d7ef",w=q;f==="music"?(M="#4fc3f7",w="#00bcd4"):f==="mic"&&(M="#00e7ff",w=q);const x=i.current,u=p.current;if(x&&u)try{x.getByteFrequencyData(u)}catch{}for(let m=0;m<l;m++){let y;if(x&&u){const C=Math.floor(m*(u.length/l)),z=u[Math.min(C,u.length-1)]/255,B=Math.pow(z,.85);y=Math.max(2,B*n*.9)}else{const C=.08+.06*Math.sin(v+m*.35);y=Math.max(2,C*n)}const R=o.createLinearGradient(0,n-y,0,n);R.addColorStop(0,M),R.addColorStop(1,w),o.fillStyle=R,o.fillRect(m*b,n-y,b*.85,y)}o.fillStyle="rgba(255,255,255,0.25)",o.fillRect(0,0,e,Math.max(1,1*c)),o.fillRect(0,n-Math.max(1,1*c),e,Math.max(1,1*c))};E();const S=()=>A();return window.addEventListener("resize",S),()=>{t.current&&cancelAnimationFrame(t.current),window.removeEventListener("resize",S),window.removeEventListener("music-analyser-ready",h),window.removeEventListener("mic-analyser-ready",h)}},[a,d,f]),L.jsx("div",{className:"w-full mx-auto",children:L.jsx("canvas",{ref:r,style:{width:"100%",height:`${a}px`,display:"block",background:"rgba(0,0,0,0.35)",border:"1px solid rgba(0,217,255,0.3)"}})})}export{P as default};
