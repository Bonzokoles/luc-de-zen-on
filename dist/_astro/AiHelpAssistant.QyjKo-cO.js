import{p as ve,H as ue,g as e,d as y,v as i,S as pe,m as fe,C as G,D as ye,i as ge,f as A,s as u,c as r,A as he,a as J,T as we,t as D,E as d,z as j,x as q,h as C,b as be,j as k,k as me,n as c,l as _e}from"./ClientRouter.astro_astro_type_script_index_0_lang.DtH6aRN_.js";/* empty css                       */import"./react.BKEw5ZbO.js";if(typeof MessageChannel>"u"){class _{constructor(){this.onmessage=null}postMessage(l){const a={data:l};(typeof queueMicrotask=="function"?queueMicrotask:p=>setTimeout(p,0))(()=>this.onmessage&&this.onmessage(a))}start(){}close(){}}class E{constructor(){this.port1=new _,this.port2=new _;const l=(a,p)=>{const o={data:p};(typeof queueMicrotask=="function"?queueMicrotask:f=>setTimeout(f,0))(()=>a.onmessage&&a.onmessage(o))};this.port1.postMessage=a=>l(this.port2,a),this.port2.postMessage=a=>l(this.port1,a)}}globalThis.MessageChannel=E}var xe=A('<div><div><div class="svelte-et2eqj"> </div> <div> </div></div></div>'),je=A('<div class="flex justify-start svelte-et2eqj"><div class="bg-white text-gray-800 border px-3 py-2 rounded-lg text-sm svelte-et2eqj"><div class="flex items-center gap-1 svelte-et2eqj"><span class="svelte-et2eqj">Agent pisze</span> <div class="flex gap-1 svelte-et2eqj"><div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.1s;"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.2s;"></div></div></div></div></div>'),qe=A('<div class="mt-2 text-xs text-gray-400 svelte-et2eqj"> </div>'),Ce=A('<div class="assistant-container svelte-et2eqj"><div class="assistant-panel svelte-et2eqj"><div class="assistant-header svelte-et2eqj"><div class="flex items-center gap-2 svelte-et2eqj"><span class="text-lg svelte-et2eqj">ðŸ¤–</span> <span class="font-medium svelte-et2eqj">POLACZEK_T Asystent</span></div> <div class="flex items-center gap-2 svelte-et2eqj"><span> </span></div></div> <div class="messages svelte-et2eqj"><!> <!></div> <div class="input-bar svelte-et2eqj"><div class="flex gap-2 mb-2 svelte-et2eqj"><button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">WyczyÅ›Ä‡</button> <button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">PoÅ‚Ä…cz ponownie</button></div> <div class="flex gap-2 svelte-et2eqj"><input placeholder="Zadaj pytanie agentowi..." class="assistant-input svelte-et2eqj"/> <button class="assistant-send svelte-et2eqj">WyÅ›lij</button></div> <!></div></div></div>');function Te(_,E){ve(E,!1);let v=y(!1),l=y([]),a=y(""),p=y(!1),o=y("disconnected"),f=y([]),g=y(),V=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const I=typeof window<"u"?window.location.origin:"",X=`${I}/api/chat`,Q=`${I}/api/health`;ue(()=>{if(typeof window<"u"){delete window.POLACZEK,window.POLACZEK={openAssistant:()=>{setTimeout(()=>Z(),30)},getStatus:()=>e(o),forceReconnect:()=>{console.log("ðŸ¤– Force reconnecting POLACZEK..."),w()}};try{window.addEventListener("polaczek-clear-chat",T),window.addEventListener("polaczek-reconnect",w)}catch{}console.log("ðŸ¤– POLACZEK API registered and ready")}return w(),()=>{}});async function w(){try{i(o,"connecting");const t=await fetch(Q,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const s=await t.json();i(v,!0),i(o,"ready"),i(f,["Chat AI","Knowledge Base","Help System"]),h("system","ðŸ¤– POLACZEK_T Assistant poÅ‚Ä…czony i gotowy do pracy!")}else throw new Error(`HTTP ${t.status}: ${t.statusText}`)}catch(t){console.error("Connection check failed:",t),i(v,!1),i(o,"disconnected"),h("error",`BÅ‚Ä…d poÅ‚Ä…czenia: ${t.message}`)}}pe(()=>{if(typeof window<"u")try{window.removeEventListener("polaczek-clear-chat",T),window.removeEventListener("polaczek-reconnect",w)}catch{}});function Z(){e(g)&&fe(g,e(g).scrollTop=e(g).scrollHeight)}function h(t,s){i(l,[...e(l),{id:Date.now()+Math.random(),type:t,content:s,timestamp:new Date().toLocaleTimeString()}])}function H(){if(!e(a).trim()||!e(v))return;const t=e(a).trim();h("user",t),i(a,""),i(p,!0),Y(t)}async function Y(t){try{const s=await fetch(X,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":V},body:JSON.stringify({prompt:t})});if(i(p,!1),s.ok){const n=await s.json();h("agent",n.answer||n.message||"Brak odpowiedzi"),n.source&&console.log(`ðŸ’¾ OdpowiedÅº z: ${n.source}`)}else{const n=await s.json().catch(()=>({error:"Unknown error"}));h("error",`BÅ‚Ä…d API (${s.status}): ${n.error||"Nieznany bÅ‚Ä…d"}`),console.error("API Error:",s.status,n)}}catch(s){i(p,!1),console.error("Request failed:",s),h("error",`BÅ‚Ä…d sieci: ${s.message}`)}}function ee(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),H())}function te(t){switch(t){case"connected":case"ready":return"text-green-500";case"error":return"text-red-500";case"disconnected":return"text-gray-500";default:return"text-yellow-500"}}function se(t){switch(t){case"connected":case"ready":return"ðŸŸ¢";case"error":return"ðŸ”´";case"disconnected":return"âšª";default:return"ðŸŸ¡"}}function T(){i(l,[])}function ae(){w()}G(()=>e(l),()=>{e(l).length>0&&setTimeout(()=>Z(),50)}),G(()=>e(o),()=>{if(typeof window<"u"){window.POLACZEK=window.POLACZEK||{},window.POLACZEK.status=e(o);try{window.dispatchEvent(new CustomEvent("polaczek-status",{detail:{status:e(o)}}))}catch{}}}),ye(),ge();var P=Ce(),B=r(P),$=r(B),N=u(r($),2),L=r(N),ne=r(L);c(L),c(N),c($);var x=u($,2),R=r(x);he(R,1,()=>e(l),t=>t.id,(t,s)=>{var n=xe(),m=r(n),K=r(m),le=r(K,!0);c(K);var S=u(K,2),de=r(S,!0);c(S),c(m),c(n),D(()=>{j(n,1,(e(s),d(()=>`flex ${e(s).type==="user"?"justify-end":"justify-start"}`)),"svelte-et2eqj"),j(m,1,(e(s),d(()=>`bubble ${e(s).type==="user"?"bubble-user":e(s).type==="agent"?"bubble-agent":e(s).type==="system"?"bubble-system":"bg-red-100 text-red-800 border border-red-200"}`)),"svelte-et2eqj"),q(le,(e(s),d(()=>e(s).content))),j(S,1,(e(s),d(()=>`text-xs mt-1 ${e(s).type==="user"?"text-blue-100":"text-gray-500"}`)),"svelte-et2eqj"),q(de,(e(s),d(()=>e(s).timestamp)))}),k(t,n)});var oe=u(R,2);{var ie=t=>{var s=je();k(t,s)};J(oe,t=>{e(p)&&t(ie)})}c(x),we(x,t=>i(g,t),()=>e(g));var F=u(x,2),M=r(F),z=r(M),U=u(z,2);c(M);var O=u(M,2),b=r(O);_e(b);var W=u(b,2);c(O);var re=u(O,2);{var ce=t=>{var s=qe(),n=r(s);c(s),D(m=>q(n,`Funkcje: ${m??""}`),[()=>(e(f),d(()=>e(f).join(", ")))]),k(t,s)};J(re,t=>{e(f),d(()=>e(f).length>0)&&t(ce)})}c(F),c(B),c(P),D((t,s,n)=>{j(L,1,t,"svelte-et2eqj"),q(ne,`${s??""}
          ${e(o)??""}`),z.disabled=(e(l),d(()=>e(l).length===0)),U.disabled=e(v),b.disabled=!e(v),W.disabled=n},[()=>(e(o),d(()=>`text-xs ${te(e(o))}`)),()=>(e(o),d(()=>se(e(o)))),()=>(e(v),e(a),d(()=>!e(v)||!e(a).trim()))]),C("click",z,T),C("click",U,ae),be(b,()=>e(a),t=>i(a,t)),C("keypress",b,ee),C("click",W,H),k(_,P),me()}export{Te as default};
