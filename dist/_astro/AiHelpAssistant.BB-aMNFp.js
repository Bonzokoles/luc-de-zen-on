import{p as we,H as be,g as e,d as h,v as r,S as _e,m as me,C as te,D as xe,i as je,f as q,a as R,j as x,k as qe,c as l,n as c,s as p,t as O,E as u,z as E,x as P,h as j,A as Ae,T as ke,l as Ce,b as Ee}from"./Header.astro_astro_type_script_index_0_lang.AXIbBUBV.js";/* empty css                       */import"./react.CU-GxeNQ.js";if(typeof MessageChannel>"u"){class T{constructor(){this.onmessage=null}postMessage(v){const i={data:v};(typeof queueMicrotask=="function"?queueMicrotask:y=>setTimeout(y,0))(()=>this.onmessage&&this.onmessage(i))}start(){}close(){}}class ${constructor(){this.port1=new T,this.port2=new T;const v=(i,y)=>{const n={data:y};(typeof queueMicrotask=="function"?queueMicrotask:w=>setTimeout(w,0))(()=>i.onmessage&&i.onmessage(n))};this.port1.postMessage=i=>v(this.port2,i),this.port2.postMessage=i=>v(this.port1,i)}}globalThis.MessageChannel=$}var Pe=q('<button class="polaczek-launcher svelte-et2eqj" aria-label="OtwÃ³rz POLACZEK AI"><span class="icon svelte-et2eqj">ðŸ¤–</span> <span class="label svelte-et2eqj">POLACZEK AI</span> <span> </span></button>'),Te=q('<div><div><div class="svelte-et2eqj"> </div> <div> </div></div></div>'),ze=q('<div class="flex justify-start svelte-et2eqj"><div class="bg-white text-gray-800 border px-3 py-2 rounded-lg text-sm svelte-et2eqj"><div class="flex items-center gap-1 svelte-et2eqj"><span class="svelte-et2eqj">Agent pisze</span> <div class="flex gap-1 svelte-et2eqj"><div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.1s;"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.2s;"></div></div></div></div></div>'),Le=q('<div class="mt-2 text-xs text-gray-400 svelte-et2eqj"> </div>'),Me=q('<div class="assistant-panel svelte-et2eqj"><div class="assistant-header svelte-et2eqj"><div class="flex items-center gap-2 svelte-et2eqj"><span class="text-lg svelte-et2eqj">ðŸ¤–</span> <span class="font-medium svelte-et2eqj">POLACZEK_T Asystent</span></div> <div class="flex items-center gap-2 svelte-et2eqj"><span> </span> <button class="text-white hover:text-gray-200 text-xl svelte-et2eqj">âˆ’</button></div></div> <div class="messages svelte-et2eqj"><!> <!></div> <div class="input-bar svelte-et2eqj"><div class="flex gap-2 mb-2 svelte-et2eqj"><button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">WyczyÅ›Ä‡</button> <button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">PoÅ‚Ä…cz ponownie</button></div> <div class="flex gap-2 svelte-et2eqj"><input placeholder="Zadaj pytanie agentowi..." class="assistant-input svelte-et2eqj"/> <button class="assistant-send svelte-et2eqj">WyÅ›lij</button></div> <!></div></div>'),Oe=q('<div class="assistant-container svelte-et2eqj"><!></div>');function Se(T,$){we($,!1);let f=h(!1),v=h([]),i=h(""),y=h(!1),n=h("disconnected"),w=h([]),z=h(!1),b=h(),se=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const F=typeof window<"u"?window.location.origin:"",ae=`${F}/api/chat`,ne=`${F}/api/health`;be(()=>{if(typeof window<"u"){delete window.POLACZEK,window.POLACZEK={openAssistant:()=>{r(z,!1),setTimeout(()=>U(),30)},getStatus:()=>e(n),forceReconnect:()=>{console.log("ðŸ¤– Force reconnecting POLACZEK..."),A()}};try{window.addEventListener("polaczek-clear-chat",K),window.addEventListener("polaczek-reconnect",A)}catch{}console.log("ðŸ¤– POLACZEK API registered and ready")}return A(),()=>{}});async function A(){try{r(n,"connecting");const t=await fetch(ne,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const s=await t.json();r(f,!0),r(n,"ready"),r(w,["Chat AI","Knowledge Base","Help System"]),_("system","ðŸ¤– POLACZEK_T Assistant poÅ‚Ä…czony i gotowy do pracy!")}else throw new Error(`HTTP ${t.status}: ${t.statusText}`)}catch(t){console.error("Connection check failed:",t),r(f,!1),r(n,"disconnected"),_("error",`BÅ‚Ä…d poÅ‚Ä…czenia: ${t.message}`)}}_e(()=>{if(typeof window<"u")try{window.removeEventListener("polaczek-clear-chat",K),window.removeEventListener("polaczek-reconnect",A)}catch{}});function U(){e(b)&&me(b,e(b).scrollTop=e(b).scrollHeight)}function _(t,s){r(v,[...e(v),{id:Date.now()+Math.random(),type:t,content:s,timestamp:new Date().toLocaleTimeString()}])}function W(){if(!e(i).trim()||!e(f))return;const t=e(i).trim();_("user",t),r(i,""),r(y,!0),oe(t)}async function oe(t){try{const s=await fetch(ae,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":se},body:JSON.stringify({prompt:t})});if(r(y,!1),s.ok){const d=await s.json();_("agent",d.answer||d.message||"Brak odpowiedzi"),d.source&&console.log(`ðŸ’¾ OdpowiedÅº z: ${d.source}`)}else{const d=await s.json().catch(()=>({error:"Unknown error"}));_("error",`BÅ‚Ä…d API (${s.status}): ${d.error||"Nieznany bÅ‚Ä…d"}`),console.error("API Error:",s.status,d)}}catch(s){r(y,!1),console.error("Request failed:",s),_("error",`BÅ‚Ä…d sieci: ${s.message}`)}}function ie(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),W())}function G(t){switch(t){case"connected":case"ready":return"text-green-500";case"error":return"text-red-500";case"disconnected":return"text-gray-500";default:return"text-yellow-500"}}function J(t){switch(t){case"connected":case"ready":return"ðŸŸ¢";case"error":return"ðŸ”´";case"disconnected":return"âšª";default:return"ðŸŸ¡"}}function V(){r(z,!e(z))}function K(){r(v,[])}function re(){A()}te(()=>e(v),()=>{e(v).length>0&&setTimeout(()=>U(),50)}),te(()=>e(n),()=>{if(typeof window<"u"){window.POLACZEK=window.POLACZEK||{},window.POLACZEK.status=e(n);try{window.dispatchEvent(new CustomEvent("polaczek-status",{detail:{status:e(n)}}))}catch{}}}),xe(),je();var I=Oe(),le=l(I);{var ce=t=>{var s=Pe(),d=p(l(s),4),L=l(d,!0);c(d),c(s),O((m,S)=>{E(d,1,m,"svelte-et2eqj"),P(L,S)},[()=>(e(n),u(()=>`status ${G(e(n))}`)),()=>(e(n),u(()=>J(e(n))))]),j("click",s,V),x(t,s)},de=t=>{var s=Me(),d=l(s),L=p(l(d),2),m=l(L),S=l(m);c(m);var ve=p(m,2);c(L),c(d);var M=p(d,2),X=l(M);Ae(X,1,()=>e(v),o=>o.id,(o,a)=>{var g=Te(),C=l(g),B=l(C),ge=l(B,!0);c(B);var N=p(B,2),he=l(N,!0);c(N),c(C),c(g),O(()=>{E(g,1,(e(a),u(()=>`flex ${e(a).type==="user"?"justify-end":"justify-start"}`)),"svelte-et2eqj"),E(C,1,(e(a),u(()=>`bubble ${e(a).type==="user"?"bubble-user":e(a).type==="agent"?"bubble-agent":e(a).type==="system"?"bubble-system":"bg-red-100 text-red-800 border border-red-200"}`)),"svelte-et2eqj"),P(ge,(e(a),u(()=>e(a).content))),E(N,1,(e(a),u(()=>`text-xs mt-1 ${e(a).type==="user"?"text-blue-100":"text-gray-500"}`)),"svelte-et2eqj"),P(he,(e(a),u(()=>e(a).timestamp)))}),x(o,g)});var ue=p(X,2);{var pe=o=>{var a=ze();x(o,a)};R(ue,o=>{e(y)&&o(pe)})}c(M),ke(M,o=>r(b,o),()=>e(b));var Q=p(M,2),Z=l(Q),D=l(Z),Y=p(D,2);c(Z);var H=p(Z,2),k=l(H);Ce(k);var ee=p(k,2);c(H);var fe=p(H,2);{var ye=o=>{var a=Le(),g=l(a);c(a),O(C=>P(g,`Funkcje: ${C??""}`),[()=>(e(w),u(()=>e(w).join(", ")))]),x(o,a)};R(fe,o=>{e(w),u(()=>e(w).length>0)&&o(ye)})}c(Q),c(s),O((o,a,g)=>{E(m,1,o,"svelte-et2eqj"),P(S,`${a??""}
            ${e(n)??""}`),D.disabled=(e(v),u(()=>e(v).length===0)),Y.disabled=e(f),k.disabled=!e(f),ee.disabled=g},[()=>(e(n),u(()=>`text-xs ${G(e(n))}`)),()=>(e(n),u(()=>J(e(n)))),()=>(e(f),e(i),u(()=>!e(f)||!e(i).trim()))]),j("click",ve,V),j("click",D,K),j("click",Y,re),Ee(k,()=>e(i),o=>r(i,o)),j("keypress",k,ie),j("click",ee,W),x(t,s)};R(le,t=>{e(z)?t(ce):t(de,!1)})}c(I),x(T,I),qe()}export{Se as default};
