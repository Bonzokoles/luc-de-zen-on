import"./disclose-version.DsnmJJEf.js";import"./legacy.kkaBD5aU.js";import{o as we,a as ge}from"./index-client.CI4zVHyS.js";import{p as _e,g as e,a as f,h as o,m as he,l as Y,o as xe,f as x,b as _,d as je,c as i,r as l,s as v,t as O,u as d}from"./template.BqTI6ysn.js";import{s as C,e as h}from"./render.DLtPj5hE.js";import{i as M}from"./if.CL3_9eW_.js";import{e as qe}from"./each.BgQDu70D.js";import{r as Ae}from"./attributes.CMoobVFc.js";import{s as k}from"./class.Cwo7PGLY.js";import{b as Ee}from"./input.BDyfk_mK.js";import{b as Ce}from"./this.zW9sjCU0.js";import{i as ke}from"./lifecycle.CZxN27Pe.js";/* empty css                                   */import"./index.DIeogL5L.js";import"./attributes.BJtm3mOD.js";var Pe=x('<button class="polaczek-launcher svelte-et2eqj" aria-label="OtwÃ³rz POLACZEK AI"><span class="icon svelte-et2eqj">ðŸ¤–</span> <span class="label svelte-et2eqj">POLACZEK AI</span> <span> </span></button>'),Te=x('<div><div><div class="svelte-et2eqj"> </div> <div> </div></div></div>'),Le=x('<div class="flex justify-start svelte-et2eqj"><div class="bg-white text-gray-800 border px-3 py-2 rounded-lg text-sm svelte-et2eqj"><div class="flex items-center gap-1 svelte-et2eqj"><span class="svelte-et2eqj">Agent pisze</span> <div class="flex gap-1 svelte-et2eqj"><div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.1s;"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-et2eqj" style="animation-delay: 0.2s;"></div></div></div></div></div>'),ze=x('<div class="mt-2 text-xs text-gray-400 svelte-et2eqj"> </div>'),Oe=x('<div class="assistant-panel svelte-et2eqj"><div class="assistant-header svelte-et2eqj"><div class="flex items-center gap-2 svelte-et2eqj"><span class="text-lg svelte-et2eqj">ðŸ¤–</span> <span class="font-medium svelte-et2eqj">POLACZEK_T Asystent</span></div> <div class="flex items-center gap-2 svelte-et2eqj"><span> </span> <button class="text-white hover:text-gray-200 text-xl svelte-et2eqj">âˆ’</button></div></div> <div class="messages svelte-et2eqj"><!> <!></div> <div class="input-bar svelte-et2eqj"><div class="flex gap-2 mb-2 svelte-et2eqj"><button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">WyczyÅ›Ä‡</button> <button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-et2eqj">PoÅ‚Ä…cz ponownie</button></div> <div class="flex gap-2 svelte-et2eqj"><input placeholder="Zadaj pytanie agentowi..." class="assistant-input svelte-et2eqj"/> <button class="assistant-send svelte-et2eqj">WyÅ›lij</button></div> <!></div></div>'),$e=x('<div class="assistant-container svelte-et2eqj"><!></div>');function Ve(ee,te){_e(te,!1);let y=f(!1),u=f([]),m=f(""),P=f(!1),r=f("disconnected"),j=f([]),T=f(!1),b=f(),se=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const N=typeof window<"u"?window.location.origin:"",ae=`${N}/api/chat`,ne=`${N}/api/health`;we(()=>{if(typeof window<"u"){delete window.POLACZEK,window.POLACZEK={openAssistant:()=>{o(T,!1),setTimeout(()=>R(),30)},getStatus:()=>e(r),forceReconnect:()=>{console.log("ðŸ¤– Force reconnecting POLACZEK..."),q()}};try{window.addEventListener("polaczek-clear-chat",$),window.addEventListener("polaczek-reconnect",q)}catch{}console.log("ðŸ¤– POLACZEK API registered and ready")}return q(),()=>{}});async function q(){try{o(r,"connecting");const t=await fetch(ne,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const s=await t.json();o(y,!0),o(r,"ready"),o(j,["Chat AI","Knowledge Base","Help System"]),w("system","ðŸ¤– POLACZEK_T Assistant poÅ‚Ä…czony i gotowy do pracy!")}else throw new Error(`HTTP ${t.status}: ${t.statusText}`)}catch(t){console.error("Connection check failed:",t),o(y,!1),o(r,"disconnected"),w("error",`BÅ‚Ä…d poÅ‚Ä…czenia: ${t.message}`)}}ge(()=>{if(typeof window<"u")try{window.removeEventListener("polaczek-clear-chat",$),window.removeEventListener("polaczek-reconnect",q)}catch{}});function R(){e(b)&&he(b,e(b).scrollTop=e(b).scrollHeight)}function w(t,s){o(u,[...e(u),{id:Date.now()+Math.random(),type:t,content:s,timestamp:new Date().toLocaleTimeString()}])}function F(){if(!e(m).trim()||!e(y))return;const t=e(m).trim();w("user",t),o(m,""),o(P,!0),re(t)}async function re(t){try{const s=await fetch(ae,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":se},body:JSON.stringify({prompt:t})});if(o(P,!1),s.ok){const c=await s.json();w("agent",c.answer||c.message||"Brak odpowiedzi"),c.source&&console.log(`ðŸ’¾ OdpowiedÅº z: ${c.source}`)}else{const c=await s.json().catch(()=>({error:"Unknown error"}));w("error",`BÅ‚Ä…d API (${s.status}): ${c.error||"Nieznany bÅ‚Ä…d"}`),console.error("API Error:",s.status,c)}}catch(s){o(P,!1),console.error("Request failed:",s),w("error",`BÅ‚Ä…d sieci: ${s.message}`)}}function oe(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),F())}function U(t){switch(t){case"connected":case"ready":return"text-green-500";case"error":return"text-red-500";case"disconnected":return"text-gray-500";default:return"text-yellow-500"}}function W(t){switch(t){case"connected":case"ready":return"ðŸŸ¢";case"error":return"ðŸ”´";case"disconnected":return"âšª";default:return"ðŸŸ¡"}}function G(){o(T,!e(T))}function $(){o(u,[])}function ie(){q()}Y(()=>e(u),()=>{e(u).length>0&&setTimeout(()=>R(),50)}),Y(()=>e(r),()=>{if(typeof window<"u"){window.POLACZEK=window.POLACZEK||{},window.POLACZEK.status=e(r);try{window.dispatchEvent(new CustomEvent("polaczek-status",{detail:{status:e(r)}}))}catch{}}}),xe(),ke();var K=$e(),le=i(K);{var ce=t=>{var s=Pe(),c=v(i(s),4),L=i(c,!0);l(c),l(s),O((g,I)=>{k(c,1,g,"svelte-et2eqj"),C(L,I)},[()=>(e(r),d(()=>`status ${U(e(r))}`)),()=>(e(r),d(()=>W(e(r))))]),h("click",s,G),_(t,s)},de=t=>{var s=Oe(),c=i(s),L=v(i(c),2),g=i(L),I=i(g);l(g);var ve=v(g,2);l(L),l(c);var z=v(c,2),J=i(z);qe(J,1,()=>e(u),n=>n.id,(n,a)=>{var p=Te(),E=i(p),B=i(E),me=i(B,!0);l(B);var H=v(B,2),be=i(H,!0);l(H),l(E),l(p),O(()=>{k(p,1,(e(a),d(()=>`flex ${e(a).type==="user"?"justify-end":"justify-start"}`)),"svelte-et2eqj"),k(E,1,(e(a),d(()=>`bubble ${e(a).type==="user"?"bubble-user":e(a).type==="agent"?"bubble-agent":e(a).type==="system"?"bubble-system":"bg-red-100 text-red-800 border border-red-200"}`)),"svelte-et2eqj"),C(me,(e(a),d(()=>e(a).content))),k(H,1,(e(a),d(()=>`text-xs mt-1 ${e(a).type==="user"?"text-blue-100":"text-gray-500"}`)),"svelte-et2eqj"),C(be,(e(a),d(()=>e(a).timestamp)))}),_(n,p)});var ue=v(J,2);{var pe=n=>{var a=Le();_(n,a)};M(ue,n=>{e(P)&&n(pe)})}l(z),Ce(z,n=>o(b,n),()=>e(b));var V=v(z,2),Z=i(V),S=i(Z),X=v(S,2);l(Z);var D=v(Z,2),A=i(D);Ae(A);var Q=v(A,2);l(D);var fe=v(D,2);{var ye=n=>{var a=ze(),p=i(a);l(a),O(E=>C(p,`Funkcje: ${E??""}`),[()=>(e(j),d(()=>e(j).join(", ")))]),_(n,a)};M(fe,n=>{e(j),d(()=>e(j).length>0)&&n(ye)})}l(V),l(s),O((n,a,p)=>{k(g,1,n,"svelte-et2eqj"),C(I,`${a??""}
            ${e(r)??""}`),S.disabled=(e(u),d(()=>e(u).length===0)),X.disabled=e(y),A.disabled=!e(y),Q.disabled=p},[()=>(e(r),d(()=>`text-xs ${U(e(r))}`)),()=>(e(r),d(()=>W(e(r)))),()=>(e(y),e(m),d(()=>!e(y)||!e(m).trim()))]),h("click",ve,G),h("click",S,$),h("click",X,ie),Ee(A,()=>e(m),n=>o(m,n)),h("keypress",A,oe),h("click",Q,F),_(t,s)};M(le,t=>{e(T)?t(ce):t(de,!1)})}l(K),_(ee,K),je()}export{Ve as default};
