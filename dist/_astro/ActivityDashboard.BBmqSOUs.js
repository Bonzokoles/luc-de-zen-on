import{p as We,G as Ee,i as Pe,t as _,s,c as e,a as b,b as m,f as Re,v as y,g as a,e as M,h as ce,j as p,k as Ye,o as $e,n as t,u as q,x as o,R as De,z as He,B as Ke,y as pe,A as ue,w as Fe}from"./Header.astro_astro_type_script_index_0_lang.C3v9REYp.js";/* empty css                                     */import"./react.0nTXIzv_.js";if(typeof MessageChannel>"u"){class O{constructor(){this.onmessage=null}postMessage(n){const i={data:n};(typeof queueMicrotask=="function"?queueMicrotask:u=>setTimeout(u,0))(()=>this.onmessage&&this.onmessage(i))}start(){}close(){}}class A{constructor(){this.port1=new O,this.port2=new O;const n=(i,u)=>{const g={data:u};(typeof queueMicrotask=="function"?queueMicrotask:w=>setTimeout(w,0))(()=>i.onmessage&&i.onmessage(g))};this.port1.postMessage=i=>n(this.port2,i),this.port2.postMessage=i=>n(this.port1,i)}}globalThis.MessageChannel=A}var Ge=_('<div class="mb-6 p-4 bg-red-900/20 border border-red-500/50 rounded-lg"><div class="flex items-center space-x-2"><span class="text-red-400 text-xl">🚨</span> <span class="font-semibold text-red-400">ANOMALIE WYKRYTE</span></div> <p class="text-red-300 mt-2">Wykryto nietypową liczbę błędów w systemie. Sprawdź logi poniżej.</p></div>'),Je=_('<div class="mb-6 p-4 bg-red-900/20 border border-red-500/50 rounded-lg"><p class="text-red-300"> </p></div>'),Ue=_('<div class="text-center py-8"><div class="animate-spin w-8 h-8 border-2 border-cyan-400 border-t-transparent rounded-full mx-auto mb-4"></div> <p class="text-gray-400">Ładowanie logów...</p></div>'),Qe=_('<div class="text-center py-8"><p class="text-gray-400">Brak logów do wyświetlenia</p></div>'),Ve=_('<div class="mt-3 p-2 bg-gray-800/50 rounded text-xs"><div class="text-gray-400 mb-1">Szczegóły:</div> <pre class="text-cyan-200 whitespace-pre-wrap"> </pre></div>'),Xe=_('<div class="bg-gray-900/30 border border-gray-700/50 rounded-lg p-4 hover:border-cyan-500/50 transition-colors"><div class="flex items-start justify-between"><div class="flex items-center space-x-3"><span class="text-lg"> </span> <div><div class="flex items-center space-x-2"><span> </span> <span class="text-xs bg-gray-700 px-2 py-1 rounded text-gray-300"> </span></div> <div class="text-sm text-gray-400 mt-1"> <!></div></div></div> <div> </div></div> <!></div>'),Ze=_('<div class="bg-black/80 backdrop-blur-sm border border-cyan-500/30 rounded-xl p-6 text-cyan-300 max-h-[800px] overflow-hidden"><div class="flex items-center justify-between mb-6"><div class="flex items-center space-x-3"><div class="w-3 h-3 bg-cyan-400 rounded-full animate-pulse"></div> <h2 class="text-2xl font-bold text-cyan-400">MONITOR AKTYWNOŚCI</h2></div> <div class="flex items-center space-x-4"><select class="bg-gray-900 border border-cyan-500/50 rounded px-3 py-1 text-cyan-300 focus:border-cyan-400 focus:outline-none"><option>Wszystkie</option><option>Info</option><option>Ostrzeżenia</option><option>Błędy</option></select> <button class="px-4 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded text-sm font-semibold transition-colors"> </button></div></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6"><div class="bg-gray-900/50 border border-cyan-500/20 rounded-lg p-4 text-center"><div class="text-2xl font-bold text-cyan-400"> </div> <div class="text-sm text-gray-400">Łącznie</div></div> <div class="bg-red-900/20 border border-red-500/30 rounded-lg p-4 text-center"><div class="text-2xl font-bold text-red-400"> </div> <div class="text-sm text-gray-400">Błędy</div></div> <div class="bg-yellow-900/20 border border-yellow-500/30 rounded-lg p-4 text-center"><div class="text-2xl font-bold text-yellow-400"> </div> <div class="text-sm text-gray-400">Ostrzeżenia</div></div> <div class="bg-cyan-900/20 border border-cyan-500/30 rounded-lg p-4 text-center"><div class="text-2xl font-bold text-cyan-400"> </div> <div class="text-sm text-gray-400">Ostatnia godzina</div></div></div> <!> <!> <div class="space-y-3 max-h-96 overflow-y-auto custom-scrollbar svelte-y4gcsn"><!></div></div>');function rt(O,A){We(A,!1);let h=M([]),n=M({total:0,errors:0,warnings:0,info:0,lastHour:0,sources:[],anomalies:!1}),i=M(!0),u=M(""),g=M("all"),w;const U={info:"text-cyan-400",warning:"text-yellow-400",error:"text-red-400"};async function I(){try{y(i,!0);const r=a(g)==="all"?"/api/activity-monitor":`/api/activity-monitor?type=${a(g)}`,v=await(await fetch(r)).json();v.success?(y(h,v.logs),y(n,v.stats)):y(u,v.message||"Failed to fetch logs")}catch(r){y(u,"Network error occurred"),console.error("Error fetching logs:",r)}finally{y(i,!1)}}function xe(r){return new Date(r).toLocaleString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}function ge(r){switch(r){case"error":return"⚠️";case"warning":return"⚡";case"info":return"ℹ️";default:return"📝"}}Ee(()=>(I(),w=setInterval(I,3e4),()=>{w&&clearInterval(w)})),Pe();var C=Ze(),N=e(C),Q=s(e(N),2),k=e(Q);b(()=>{a(g),$e(()=>{})});var B=e(k);B.value=(B.__value="all")==null?"":"all";var L=s(B);L.value=(L.__value="info")==null?"":"info";var S=s(L);S.value=(S.__value="warning")==null?"":"warning";var V=s(S);V.value=(V.__value="error")==null?"":"error",t(k);var z=s(k,2),ye=e(z,!0);t(z),t(Q),t(N);var W=s(N,2),E=e(W),X=e(E),_e=e(X,!0);t(X),q(2),t(E);var P=s(E,2),Z=e(P),fe=e(Z,!0);t(Z),q(2),t(P);var R=s(P,2),ee=e(R),be=e(ee,!0);t(ee),q(2),t(R);var te=s(R,2),ae=e(te),me=e(ae,!0);t(ae),q(2),t(te),t(W);var re=s(W,2);{var he=r=>{var l=Ge();p(r,l)};m(re,r=>{a(n).anomalies&&r(he)})}var se=s(re,2);{var we=r=>{var l=Je(),v=e(l),Y=e(v);t(v),t(l),b(()=>o(Y,`❌ ${a(u)??""}`)),p(r,l)};m(se,r=>{a(u)&&r(we)})}var ie=s(se,2),ke=e(ie);{var Me=r=>{var l=Ue();p(r,l)},Oe=(r,l)=>{{var v=f=>{var T=Qe();p(f,T)},Y=f=>{var T=De(),Ie=He(T);Ke(Ie,1,()=>a(h),$=>$.id,($,d)=>{var D=Xe(),H=e(D),K=e(H),F=e(K),ze=e(F,!0);t(F);var oe=s(F,2),G=e(oe),j=e(G),Te=e(j,!0);t(j);var ne=s(j,2),je=e(ne,!0);t(ne),t(G);var de=s(G,2),le=e(de),qe=s(le);{var Ae=c=>{var x=Fe();b(()=>o(x,`• User: ${a(d).userId??""}`)),p(c,x)};m(qe,c=>{a(d).userId&&c(Ae)})}t(de),t(oe),t(K);var J=s(K,2),Ce=e(J,!0);t(J),t(H);var Ne=s(H,2);{var Be=c=>{var x=Ve(),ve=s(e(x),2),Le=e(ve,!0);t(ve),t(x),b(Se=>o(Le,Se),[()=>JSON.stringify(a(d).details,null,2)],pe),p(c,x)};m(Ne,c=>{Object.keys(a(d).details).length>0&&c(Be)})}t(D),b((c,x)=>{o(ze,c),ue(j,1,`font-semibold ${U[a(d).type]??""}`,"svelte-y4gcsn"),o(Te,a(d).action),o(je,a(d).source),o(le,`${x??""} `),ue(J,1,`text-xs ${U[a(d).type]??""} font-semibold uppercase`,"svelte-y4gcsn"),o(Ce,a(d).type)},[()=>ge(a(d).type),()=>xe(a(d).timestamp)],pe),p($,D)}),p(f,T)};m(r,f=>{a(h).length===0?f(v):f(Y,!1)},l)}};m(ke,r=>{a(i)?r(Me):r(Oe,!1)})}t(ie),t(C),b(()=>{z.disabled=a(i),o(ye,a(i)?"Odświeżanie...":"🔄 Odśwież"),o(_e,a(n).total),o(fe,a(n).errors),o(be,a(n).warnings),o(me,a(n).lastHour)}),Re(k,()=>a(g),r=>y(g,r)),ce("change",k,I),ce("click",z,I),p(O,C),Ye()}export{rt as default};
