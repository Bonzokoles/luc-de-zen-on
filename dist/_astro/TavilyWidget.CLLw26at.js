import"./disclose-version.DsnmJJEf.js";import"./legacy.kkaBD5aU.js";import{c as Ee}from"./index-client.CI4zVHyS.js";import{p as Pe,f,s as i,c as t,t as _,g as e,a as D,h as o,b as d,d as je,r as s,j as Re,q as Se,k as Ae}from"./template.BqTI6ysn.js";import{s as c,e as k}from"./render.DLtPj5hE.js";import{i as m}from"./if.CL3_9eW_.js";import{e as Ie,i as Oe}from"./each.BgQDu70D.js";import{r as Le}from"./attributes.CMoobVFc.js";import{s as $e}from"./class.Cwo7PGLY.js";import{b as Ce}from"./input.BDyfk_mK.js";import{i as Fe}from"./lifecycle.CZxN27Pe.js";/* empty css                                   */import"./index.DIeogL5L.js";import"./attributes.BJtm3mOD.js";var Ke=f('<div class="error-message svelte-vqitbf"><div class="error-icon svelte-vqitbf">⚠️</div> <p class="svelte-vqitbf"> </p></div>'),Ne=f('<div class="ai-answer svelte-vqitbf"><h4 class="svelte-vqitbf">🤖 AI Odpowiedź:</h4> <p class="svelte-vqitbf"> </p></div>'),He=f('<span class="result-date"> </span>'),Je=f('<div class="result-card svelte-vqitbf"><div class="result-header svelte-vqitbf"><h5 class="result-title svelte-vqitbf"> </h5> <span class="result-score svelte-vqitbf"> </span></div> <p class="result-content svelte-vqitbf"> </p> <div class="result-footer svelte-vqitbf"><span class="result-url svelte-vqitbf"> </span> <!></div></div>'),Qe=f('<div class="usage-info svelte-vqitbf"><span> </span> <span> </span></div>'),Ue=f('<div class="results-display svelte-vqitbf"><div class="query-info svelte-vqitbf"><strong>Wyszukiwanie:</strong> </div> <!> <div class="search-results svelte-vqitbf"><h4 class="svelte-vqitbf">📝 Wyniki wyszukiwania:</h4> <!></div> <!></div>'),Ze=f('<div class="results-container svelte-vqitbf"><!> <div class="actions svelte-vqitbf"><button class="clear-btn svelte-vqitbf" title="Wyczyść wyniki">🗑️</button></div></div>'),Be=f('<span class="spinner svelte-vqitbf"></span>'),Ge=f('<div><div class="widget-header svelte-vqitbf"><div class="title-section svelte-vqitbf"><h3 class="svelte-vqitbf">🌐 Tavily AI Search</h3> <span class="service-badge svelte-vqitbf">AI Powered</span></div> <div class="header-actions svelte-vqitbf"><button class="expand-btn svelte-vqitbf" title="Rozwiń/Zwiń"> </button> <button class="full-btn svelte-vqitbf" title="Otwórz pełne wyszukiwanie">🔗</button></div></div> <div class="widget-content svelte-vqitbf"><!> <div class="input-section svelte-vqitbf"><div class="input-container svelte-vqitbf"><input type="text" placeholder="Wyszukaj w internecie..." class="search-input svelte-vqitbf"/> <button class="search-btn svelte-vqitbf" title="Wyszukaj w internecie"><!></button></div></div></div></div>');function dt(ee,te){Pe(te,!1);const se=Ee();let q=D(""),l=D(null),h=D(!1),w=D(null),z=D(!1);async function H(){if(!e(q).trim()||e(h))return;const a=e(q).trim();o(q,""),o(h,!0),o(w,null);try{const r=await fetch("/api/tavi",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a,maxResults:5,includeAnswer:!0,includeImages:!1})});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const p=await r.json();if(p.status==="success")o(l,p),se("searchCompleted",{results:p});else throw new Error(p.error||"Nie udało się wykonać wyszukiwania")}catch(r){o(w,r.message),o(l,null),console.error("Tavily error:",r)}finally{o(h,!1)}}function ae(a){a.key==="Enter"&&!a.shiftKey&&(a.preventDefault(),H())}function ie(){o(z,!e(z))}function re(){window.open("/tavily-search","_blank")}function ve(){o(l,null),o(w,null)}function le(a){window.open(a,"_blank")}Fe();var E=Ge();let J;var S=t(E),Q=i(t(S),2),P=t(Q),ne=t(P,!0);s(P);var oe=i(P,2);s(Q),s(S);var U=i(S,2),Z=t(U);{var de=a=>{var r=Ze(),p=t(r);{var pe=y=>{var g=Ke(),R=i(t(g),2),A=t(R,!0);s(R),s(g),_(()=>c(A,e(w))),d(y,g)},be=y=>{var g=Se(),R=Ae(g);{var A=I=>{var O=Ue(),L=t(O),me=i(t(L));s(L);var V=i(L,2);{var qe=u=>{var v=Ne(),n=i(t(v),2),b=t(n,!0);s(n),s(v),_(()=>c(b,e(l).answer)),d(u,v)};m(V,u=>{e(l).answer&&u(qe)})}var $=i(V,2),he=i(t($),2);Ie(he,1,()=>e(l).results,Oe,(u,v)=>{var n=Je(),b=t(n),x=t(b),C=t(x,!0);s(x);var X=i(x,2),ge=t(X);s(X),s(b);var F=i(b,2),xe=t(F,!0);s(F);var Y=i(F,2),K=t(Y),ke=t(K,!0);s(K);var ze=i(K,2);{var Te=W=>{var N=He(),We=t(N,!0);s(N),_(De=>c(We,De),[()=>new Date(e(v).publishedDate).toLocaleDateString("pl-PL")]),d(W,N)};m(ze,W=>{e(v).publishedDate&&W(Te)})}s(Y),s(n),_(W=>{c(C,e(v).title),c(ge,`Score: ${W??""}%`),c(xe,e(v).content),c(ke,e(v).url)},[()=>(e(v).score*100).toFixed(0)]),k("click",n,()=>le(e(v).url)),d(u,n)}),s($);var we=i($,2);{var ye=u=>{var v=Qe(),n=t(v),b=t(n);s(n);var x=i(n,2),C=t(x);s(x),s(v),_(()=>{c(b,`Tokeny: ${e(l).usage.tokensUsed??""}`),c(C,`Pozostało: ${e(l).usage.requestsRemaining??""}`)}),d(u,v)};m(we,u=>{e(l).usage&&u(ye)})}s(O),_(()=>c(me,` ${e(l).query??""}`)),d(I,O)};m(R,I=>{e(l)&&I(A)},!0)}d(y,g)};m(p,y=>{e(w)?y(pe):y(be,!1)})}var M=i(p,2),_e=t(M);s(M),s(r),k("click",_e,ve),d(a,r)};m(Z,a=>{e(z)&&(e(l)||e(w))&&a(de)})}var B=i(Z,2),G=t(B),T=t(G);Le(T);var j=i(T,2),ce=t(j);{var ue=a=>{var r=Be();d(a,r)},fe=a=>{var r=Re("🌐");d(a,r)};m(ce,a=>{e(h)?a(ue):a(fe,!1)})}s(j),s(G),s(B),s(U),s(E),_((a,r)=>{J=$e(E,1,"tavily-widget svelte-vqitbf",null,J,a),c(ne,e(z)?"▼":"▲"),T.disabled=e(h),j.disabled=r},[()=>({expanded:e(z)}),()=>!e(q).trim()||e(h)]),k("click",P,ie),k("click",oe,re),Ce(T,()=>e(q),a=>o(q,a)),k("keypress",T,ae),k("click",j,H),d(ee,E),je()}export{dt as default};
