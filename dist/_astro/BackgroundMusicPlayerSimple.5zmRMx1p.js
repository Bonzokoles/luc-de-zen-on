import"./disclose-version.DsnmJJEf.js";import"./legacy.kkaBD5aU.js";import{o as Se}from"./index-client.CI4zVHyS.js";import{p as Ae,g as e,a as f,h as l,m as g,f as L,c as n,s as o,t as te,b as M,d as Ce,r as s,q as Me,k as Te}from"./template.BqTI6ysn.js";import{e as u,s as D}from"./render.DLtPj5hE.js";import{i as ae}from"./if.CL3_9eW_.js";import{e as Ie,i as Ue}from"./each.BgQDu70D.js";import{r as Ee,a as ie,s as xe}from"./attributes.CMoobVFc.js";import{s as De}from"./class.Cwo7PGLY.js";import{s as Le}from"./style.eybEfuFE.js";import{b as Ne}from"./this.zW9sjCU0.js";import{i as Pe}from"./lifecycle.CZxN27Pe.js";/* empty css                                    */import"./index.DIeogL5L.js";import"./attributes.BJtm3mOD.js";var Re=L('<div class="panel-content svelte-u12wbg"><div class="now-playing svelte-u12wbg"><div class="track-info svelte-u12wbg"><div class="track-name svelte-u12wbg"> </div> <div class="track-time svelte-u12wbg"> </div></div></div> <div class="player-controls svelte-u12wbg"><button class="control-btn svelte-u12wbg">⏮</button> <button class="control-btn play-pause svelte-u12wbg"> </button> <button class="control-btn svelte-u12wbg">⏭</button> <button class="control-btn svelte-u12wbg">📋</button></div> <div class="volume-control svelte-u12wbg"><span class="svelte-u12wbg">🔊</span> <input type="range" min="0" max="100" class="volume-slider svelte-u12wbg"/></div> <div class="progress-container svelte-u12wbg"><div class="progress-bar svelte-u12wbg" role="slider" tabindex="0" aria-label="Seek"><div class="progress-fill svelte-u12wbg"></div></div></div></div>'),Oe=L('<div class="playlist-empty svelte-u12wbg">No tracks loaded</div>'),Be=L("<button> </button>"),Xe=L('<div class="playlist-panel svelte-u12wbg"><div class="playlist-header svelte-u12wbg"><span>🎵 PLAYLIST</span> <button class="close-btn svelte-u12wbg">×</button></div> <div class="playlist-content svelte-u12wbg"><!></div> <div class="playlist-actions svelte-u12wbg"><input type="file" webkitdirectory multiple accept="audio/*" style="display: none;" id="music-folder"/> <button class="action-btn svelte-u12wbg">📁 Load Folder</button> <button class="action-btn svelte-u12wbg">🎵 Demo Tracks</button></div></div>'),ze=L('<div class="background-music-player in-flow svelte-u12wbg"><audio preload="metadata" crossorigin="anonymous"></audio> <div class="music-control-panel svelte-u12wbg"><div class="panel-header svelte-u12wbg"><span>🎵 MUSIC • POLACZEK</span> <button class="minimize-btn svelte-u12wbg"> </button></div> <!></div> <!></div>');function at(oe,ce){Ae(ce,!1);let a=f(),v,w,N,c=f([]),d=f(0),_=f(!1),P=f(!1),y=f(.5),R=f(0),m=f(0),T=f(!1),Y=f("No track selected");Se(()=>{O(),typeof window<"u"&&(delete window.MUSIC,window.MUSIC={play:()=>{e(_)||B()},pause:()=>{e(_)&&B()},toggle:()=>B(),next:()=>H(),prev:()=>se(),togglePlaylist:()=>re(),setVolume:t=>{const i=Math.max(0,Math.min(1,Number(t)));l(y,i),e(a)&&g(a,e(a).volume=e(y))},getState:()=>({isPlaying:e(_),trackName:e(Y),volume:e(y)}),ensureLoaded:()=>{e(c).length?I():O()},getAnalyser:()=>w||window.MUSIC_ANALYSER||null,openFolderPicker:()=>{try{const t=document.getElementById("music-folder");t&&typeof t.click=="function"&&t.click()}catch(t){console.warn("Folder picker not available:",t)}}},console.log("🎵 MUSIC API registered and ready"))});function ne(){try{if(!e(a)||w)return;const t=window.AudioContext||window.webkitAudioContext;if(!t)return;v=window.MUSIC_AUDIO_CTX||new t,v.state==="suspended"&&v.resume().catch(()=>{}),window.MUSIC_MEDIA_SOURCE?N=window.MUSIC_MEDIA_SOURCE:(N=v.createMediaElementSource(e(a)),window.MUSIC_MEDIA_SOURCE=N),w=window.MUSIC_ANALYSER||v.createAnalyser(),w.fftSize=1024,w.smoothingTimeConstant=.85;try{N.connect(w),w.connect(v.destination)}catch{}window.MUSIC_AUDIO_CTX=v,window.MUSIC_ANALYSER=w,window.dispatchEvent(new CustomEvent("music-analyser-ready"));try{const i=window.MIC_AUDIO_CTX;i&&i.state==="suspended"&&i.resume().catch(()=>{})}catch{}}catch(t){console.warn("setupAnalyser failed",t)}}function O(){l(c,[{name:"MERKABA",url:"https://assets.codepen.io/7558/Merkaba.mp3"},{name:"DHAMIKA",url:"https://assets.codepen.io/7558/Dhamika.mp3"},{name:"VACANT",url:"https://assets.codepen.io/7558/Vacant.mp3"},{name:"LXSTNGHT",url:"https://assets.codepen.io/7558/lxstnght-back_1.mp3"}]),I()}function I(){e(c)[e(d)]&&(l(Y,e(c)[e(d)].name),e(a)&&e(c)[e(d)].url&&(g(a,e(a).src=e(c)[e(d)].url),g(a,e(a).volume=e(y)),ne()))}function B(){if(!e(c)[e(d)]){O();return}e(a).src||I(),e(_)?(e(a).pause(),l(_,!1)):(ne(),e(a).play().then(()=>{l(_,!0);try{v&&v.state==="suspended"&&v.resume()}catch{}}).catch(console.error))}function $(t){t>=0&&t<e(c).length&&(l(d,t),I(),e(_)&&e(a).play())}function se(){e(c).length>0&&(l(d,(e(d)-1+e(c).length)%e(c).length),$(e(d)))}function H(){e(c).length>0&&(l(d,(e(d)+1)%e(c).length),$(e(d)))}function ue(){e(a)&&(l(R,e(a).currentTime),l(m,e(a).duration||0))}function de(){H()}function ve(t){l(y,t.target.value/100),e(a)&&g(a,e(a).volume=e(y))}function me(t){if(e(a)&&e(m)){const i=t.currentTarget.getBoundingClientRect(),r=(t.clientX-i.left)/i.width;g(a,e(a).currentTime=r*e(m))}}function pe(t){if(!e(a)||!e(m))return;const i=5;t.key==="ArrowRight"?(g(a,e(a).currentTime=Math.min(e(m),e(a).currentTime+i)),t.preventDefault()):t.key==="ArrowLeft"?(g(a,e(a).currentTime=Math.max(0,e(a).currentTime-i)),t.preventDefault()):t.key==="Home"?(g(a,e(a).currentTime=0),t.preventDefault()):t.key==="End"?(g(a,e(a).currentTime=e(m)),t.preventDefault()):(t.key==="Enter"||t.key===" ")&&t.preventDefault()}function le(t){const i=Math.floor(t/60),r=Math.floor(t%60);return`${i}:${r.toString().padStart(2,"0")}`}function fe(t){const i=Array.from(t.target.files).filter(r=>r.type.startsWith("audio/"));l(c,i.map(r=>({name:r.name.replace(/\.[^/.]+$/,""),file:r,url:URL.createObjectURL(r)}))),l(d,0),I(),l(T,!0)}function re(){l(T,!e(T))}function be(){l(P,!e(P))}Pe();var j=ze(),X=n(j);Ne(X,t=>l(a,t),()=>e(a));var q=o(X,2),G=n(q),W=o(n(G),2),ge=n(W,!0);s(W),s(G);var we=o(G,2);{var _e=t=>{var i=Re(),r=n(i),z=n(r),h=n(z),Z=n(h,!0);s(h);var F=o(h,2),J=n(F);s(F),s(z),s(r);var A=o(r,2),U=n(A),k=o(U,2),Q=n(k,!0);s(k);var b=o(k,2),C=o(b,2);s(A);var E=o(A,2),x=o(n(E),2);Ee(x),s(E);var K=o(E,2),p=n(K);ie(p,"aria-valuemin",0);var S=n(p);s(p),s(K),s(i),te((V,ee)=>{D(Z,e(Y)),D(J,`${V??""} / ${ee??""}`),D(Q,e(_)?"⏸":"▶"),xe(x,e(y)*100),ie(p,"aria-valuemax",e(m)||0),ie(p,"aria-valuenow",e(R)||0),Le(S,`width: ${e(m)?e(R)/e(m)*100:0}%`)},[()=>le(e(R)),()=>le(e(m))]),u("click",U,se),u("click",k,B),u("click",b,H),u("click",C,re),u("input",x,ve),u("click",p,me),u("keydown",p,pe),M(t,i)};ae(we,t=>{e(P)||t(_e)})}s(q);var ye=o(q,2);{var he=t=>{var i=Xe(),r=n(i),z=o(n(r),2);s(r);var h=o(r,2),Z=n(h);{var F=b=>{var C=Oe();M(b,C)},J=b=>{var C=Me(),E=Te(C);Ie(E,1,()=>e(c),Ue,(x,K,p)=>{var S=Be();let V;var ee=n(S,!0);s(S),te(ke=>{V=De(S,1,"playlist-item svelte-u12wbg",null,V,ke),D(ee,e(K).name)},[()=>({active:p===e(d)})]),u("click",S,()=>$(p)),M(x,S)}),M(b,C)};ae(Z,b=>{e(c).length===0?b(F):b(J,!1)})}s(h);var A=o(h,2),U=n(A),k=o(U,2),Q=o(k,2);s(A),s(i),u("click",z,()=>l(T,!1)),u("change",U,fe),u("click",k,()=>document.getElementById("music-folder").click()),u("click",Q,O),M(t,i)};ae(ye,t=>{e(T)&&t(he)})}s(j),te(()=>D(ge,e(P)?"+":"−")),u("timeupdate",X,ue),u("ended",X,de),u("click",W,be),M(oe,j),Ce()}export{at as default};
