import{p as he,G as we,g as e,e as g,v as n,O as be,m as _e,D as te,E as xe,i as Ae,t as x,b as N,j as b,k as ke,c as o,n as i,s as v,a as $,y as R,A as P,x as T,h as _,B as Ce,P as Ee,l as Pe,d as Te}from"./Header.astro_astro_type_script_index_0_lang.C3v9REYp.js";/* empty css                       */import"./react.0nTXIzv_.js";if(typeof MessageChannel>"u"){class L{constructor(){this.onmessage=null}postMessage(u){const r={data:u};(typeof queueMicrotask=="function"?queueMicrotask:m=>setTimeout(m,0))(()=>this.onmessage&&this.onmessage(r))}start(){}close(){}}class K{constructor(){this.port1=new L,this.port2=new L;const u=(r,m)=>{const c={data:m};(typeof queueMicrotask=="function"?queueMicrotask:A=>setTimeout(A,0))(()=>r.onmessage&&r.onmessage(c))};this.port1.postMessage=r=>u(this.port2,r),this.port2.postMessage=r=>u(this.port1,r)}}globalThis.MessageChannel=K}var Le=x('<button class="polaczek-launcher svelte-12mp6du" aria-label="OtwÃ³rz POLACZEK AI"><span class="icon svelte-12mp6du">ðŸ¤–</span> <span class="label svelte-12mp6du">POLACZEK AI</span> <span> </span></button>'),Oe=x('<div><div><div class="svelte-12mp6du"> </div> <div> </div></div></div>'),ze=x('<div class="flex justify-start svelte-12mp6du"><div class="bg-white text-gray-800 border px-3 py-2 rounded-lg text-sm svelte-12mp6du"><div class="flex items-center gap-1 svelte-12mp6du"><span class="svelte-12mp6du">Agent pisze</span> <div class="flex gap-1 svelte-12mp6du"><div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-12mp6du"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-12mp6du" style="animation-delay: 0.1s;"></div> <div class="w-1 h-1 bg-gray-400 rounded-full animate-bounce svelte-12mp6du" style="animation-delay: 0.2s;"></div></div></div></div></div>'),Me=x('<div class="mt-2 text-xs text-gray-400 svelte-12mp6du"> </div>'),$e=x('<div class="assistant-panel svelte-12mp6du"><div class="assistant-header svelte-12mp6du"><div class="flex items-center gap-2 svelte-12mp6du"><span class="text-lg svelte-12mp6du">ðŸ¤–</span> <span class="font-medium svelte-12mp6du">POLACZEK_T Asystent</span></div> <div class="flex items-center gap-2 svelte-12mp6du"><span> </span> <button class="text-white hover:text-gray-200 text-xl svelte-12mp6du">âˆ’</button></div></div> <div class="messages svelte-12mp6du"><!> <!></div> <div class="input-bar svelte-12mp6du"><div class="flex gap-2 mb-2 svelte-12mp6du"><button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-12mp6du">WyczyÅ›Ä‡</button> <button class="text-xs text-gray-400 hover:text-gray-200 px-2 py-1 svelte-12mp6du">PoÅ‚Ä…cz ponownie</button></div> <div class="flex gap-2 svelte-12mp6du"><input placeholder="Zadaj pytanie agentowi..." class="assistant-input svelte-12mp6du"> <button class="assistant-send svelte-12mp6du">WyÅ›lij</button></div> <!></div></div>'),Ke=x('<div class="assistant-container svelte-12mp6du"><!></div>');function Se(L,K){he(K,!1);let p=g(!1),u=g([]),r=g(""),m=g(!1),c=g("disconnected"),A=g([]),O=g(!1),y=g(),se=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;const F=typeof window<"u"?window.location.origin:"",ae=`${F}/api/chat`,ne=`${F}/api/health`;we(()=>{if(typeof window<"u"){delete window.POLACZEK,window.POLACZEK={openAssistant:()=>{n(O,!1),setTimeout(()=>G(),30)},getStatus:()=>e(c),forceReconnect:()=>{console.log("ðŸ¤– Force reconnecting POLACZEK..."),k()}};try{window.addEventListener("polaczek-clear-chat",j),window.addEventListener("polaczek-reconnect",k)}catch{}console.log("ðŸ¤– POLACZEK API registered and ready")}return k(),()=>{}});async function k(){try{n(c,"connecting");const t=await fetch(ne,{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){const s=await t.json();n(p,!0),n(c,"ready"),n(A,["Chat AI","Knowledge Base","Help System"]),h("system","ðŸ¤– POLACZEK_T Assistant poÅ‚Ä…czony i gotowy do pracy!")}else throw new Error(`HTTP ${t.status}: ${t.statusText}`)}catch(t){console.error("Connection check failed:",t),n(p,!1),n(c,"disconnected"),h("error",`BÅ‚Ä…d poÅ‚Ä…czenia: ${t.message}`)}}be(()=>{if(typeof window<"u")try{window.removeEventListener("polaczek-clear-chat",j),window.removeEventListener("polaczek-reconnect",k)}catch{}});function G(){e(y)&&_e(y,e(y).scrollTop=e(y).scrollHeight)}function h(t,s){n(u,[...e(u),{id:Date.now()+Math.random(),type:t,content:s,timestamp:new Date().toLocaleTimeString()}])}function U(){if(!e(r).trim()||!e(p))return;const t=e(r).trim();h("user",t),n(r,""),n(m,!0),oe(t)}async function oe(t){try{const s=await fetch(ae,{method:"POST",headers:{"Content-Type":"application/json","X-Session-ID":se},body:JSON.stringify({prompt:t})});if(n(m,!1),s.ok){const d=await s.json();h("agent",d.answer||d.message||"Brak odpowiedzi"),d.source&&console.log(`ðŸ’¾ OdpowiedÅº z: ${d.source}`)}else{const d=await s.json().catch(()=>({error:"Unknown error"}));h("error",`BÅ‚Ä…d API (${s.status}): ${d.error||"Nieznany bÅ‚Ä…d"}`),console.error("API Error:",s.status,d)}}catch(s){n(m,!1),console.error("Request failed:",s),h("error",`BÅ‚Ä…d sieci: ${s.message}`)}}function ie(t){t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),U())}function W(t){switch(t){case"connected":case"ready":return"text-green-500";case"error":return"text-red-500";case"disconnected":return"text-gray-500";default:return"text-yellow-500"}}function J(t){switch(t){case"connected":case"ready":return"ðŸŸ¢";case"error":return"ðŸ”´";case"disconnected":return"âšª";default:return"ðŸŸ¡"}}function V(){n(O,!e(O))}function j(){n(u,[])}function re(){k()}te(()=>e(u),()=>{e(u).length>0&&setTimeout(()=>G(),50)}),te(()=>e(c),()=>{if(typeof window<"u"){window.POLACZEK=window.POLACZEK||{},window.POLACZEK.status=e(c);try{window.dispatchEvent(new CustomEvent("polaczek-status",{detail:{status:e(c)}}))}catch{}}}),xe(),Ae();var I=Ke(),de=o(I);{var le=t=>{var s=Le(),d=v(o(s),4),z=o(d,!0);i(d),i(s),$((w,Z)=>{P(d,1,w,"svelte-12mp6du"),T(z,Z)},[()=>`status ${W(e(c))}`,()=>J(e(c))],R),_("click",s,V),b(t,s)},ce=t=>{var s=$e(),d=o(s),z=v(o(d),2),w=o(z),Z=o(w);i(w);var ue=v(w,2);i(z),i(d);var M=v(d,2),X=o(M);Ce(X,1,()=>e(u),a=>a.id,(a,l)=>{var f=Oe(),E=o(f),q=o(E),ge=o(q,!0);i(q);var H=v(q,2),ye=o(H,!0);i(H),i(E),i(f),$(()=>{P(f,1,`flex ${e(l).type==="user"?"justify-end":"justify-start"}`,"svelte-12mp6du"),P(E,1,`bubble ${e(l).type==="user"?"bubble-user":e(l).type==="agent"?"bubble-agent":e(l).type==="system"?"bubble-system":"bg-red-100 text-red-800 border border-red-200"}`,"svelte-12mp6du"),T(ge,e(l).content),P(H,1,`text-xs mt-1 ${e(l).type==="user"?"text-blue-100":"text-gray-500"}`,"svelte-12mp6du"),T(ye,e(l).timestamp)}),b(a,f)});var ve=v(X,2);{var pe=a=>{var l=ze();b(a,l)};N(ve,a=>{e(m)&&a(pe)})}i(M),Ee(M,a=>n(y,a),()=>e(y));var Q=v(M,2),S=o(Q),D=o(S),Y=v(D,2);i(S);var B=v(S,2),C=o(B);Pe(C);var ee=v(C,2);i(B);var me=v(B,2);{var fe=a=>{var l=Me(),f=o(l);i(l),$(E=>T(f,`Funkcje: ${E??""}`),[()=>e(A).join(", ")],R),b(a,l)};N(me,a=>{e(A).length>0&&a(fe)})}i(Q),i(s),$((a,l,f)=>{P(w,1,a,"svelte-12mp6du"),T(Z,`${l??""}
            ${e(c)??""}`),D.disabled=e(u).length===0,Y.disabled=e(p),C.disabled=!e(p),ee.disabled=f},[()=>`text-xs ${W(e(c))}`,()=>J(e(c)),()=>!e(p)||!e(r).trim()],R),_("click",ue,V),_("click",D,j),_("click",Y,re),Te(C,()=>e(r),a=>n(r,a)),_("keypress",C,ie),_("click",ee,U),b(t,s)};N(de,t=>{e(O)?t(le):t(ce,!1)})}i(I),b(L,I),ke()}export{Se as default};
