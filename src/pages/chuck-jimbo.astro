---
import MainLayout from '../layouts/MainLayout.astro';
---

<MainLayout title="CHUCK + Jimbo - AI Workflow Builder">
  <div class="container mx-auto px-4 py-8">
    <header class="mb-8">
      <h1 class="text-4xl font-bold mb-2">ü§ñ CHUCK + Jimbo</h1>
      <p class="text-xl text-gray-600">Universal AI Workflow Builder - 140+ Tools</p>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
      <!-- Stats Cards -->
      <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
        <div class="text-3xl font-bold text-blue-600 mb-2">140+</div>
        <div class="text-gray-700">AI Tools Available</div>
      </div>
      
      <div class="bg-green-50 border-2 border-green-200 rounded-lg p-6">
        <div class="text-3xl font-bold text-green-600 mb-2">3</div>
        <div class="text-gray-700">Universal Node Types</div>
      </div>
      
      <div class="bg-purple-50 border-2 border-purple-200 rounded-lg p-6">
        <div class="text-3xl font-bold text-purple-600 mb-2">5</div>
        <div class="text-gray-700">Tool Categories</div>
      </div>
    </div>

    <!-- Categories -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">üì¶ Kategorie Narzƒôdzi</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        <div class="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors">
          <h3 class="font-bold text-lg mb-2">üìù SEO/Content (20)</h3>
          <p class="text-sm text-gray-600 mb-3">Perplexity, Notion AI, MarketMuse, Jasper...</p>
          <div class="text-sm"><strong>≈öredni score:</strong> 91/100</div>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors">
          <h3 class="font-bold text-lg mb-2">üíª Code/Dev (25)</h3>
          <p class="text-sm text-gray-600 mb-3">Cursor, GitHub Copilot, Replit AI, V0...</p>
          <div class="text-sm"><strong>≈öredni score:</strong> 90/100</div>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors">
          <h3 class="font-bold text-lg mb-2">üõí E-commerce/B2B (30)</h3>
          <p class="text-sm text-gray-600 mb-3">Klaviyo, Gorgias, HubSpot, Salesforce...</p>
          <div class="text-sm"><strong>≈öredni score:</strong> 91/100</div>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors">
          <h3 class="font-bold text-lg mb-2">üé® Creative/Productivity (35)</h3>
          <p class="text-sm text-gray-600 mb-3">Canva AI, Midjourney, Notion, Adobe...</p>
          <div class="text-sm"><strong>≈öredni score:</strong> 91/100</div>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-400 transition-colors">
          <h3 class="font-bold text-lg mb-2">üÜï Nowe 2026 (30)</h3>
          <p class="text-sm text-gray-600 mb-3">Sora, RunwayML, Claude, Gemini, Luma AI...</p>
          <div class="text-sm"><strong>≈öredni score:</strong> 91/100</div>
        </div>
      </div>
    </section>

    <!-- Universal Nodes -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">üîß Jimbo Universal Nodes</h2>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 border-2 border-blue-300 rounded-lg p-6">
          <div class="text-4xl mb-3">ü§ñ</div>
          <h3 class="font-bold text-lg mb-2">AI_AGENT</h3>
          <p class="text-sm text-gray-700 mb-3">Deleguje wykonanie do CHUCK API</p>
          <code class="text-xs bg-white px-2 py-1 rounded">localhost:5152/api/exec</code>
        </div>

        <div class="bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-300 rounded-lg p-6">
          <div class="text-4xl mb-3">‚öôÔ∏è</div>
          <h3 class="font-bold text-lg mb-2">PROCESSOR</h3>
          <p class="text-sm text-gray-700 mb-3">Scraping, transformacja, eksport</p>
          <code class="text-xs bg-white px-2 py-1 rounded">scrape | transform | export</code>
        </div>

        <div class="bg-gradient-to-br from-purple-50 to-purple-100 border-2 border-purple-300 rounded-lg p-6">
          <div class="text-4xl mb-3">üì§</div>
          <h3 class="font-bold text-lg mb-2">OUTPUT</h3>
          <p class="text-sm text-gray-700 mb-3">Email, PDF, Slack, Webhook</p>
          <code class="text-xs bg-white px-2 py-1 rounded">email | pdf | slack</code>
        </div>
      </div>
    </section>

    <!-- API Demo -->
    <section class="mb-8">
      <h2 class="text-2xl font-bold mb-4">üîå API Endpoints</h2>
      <div class="space-y-4">
        <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-2">
              <span class="bg-green-100 text-green-700 px-2 py-1 rounded text-sm font-mono">GET</span>
              <code class="text-sm">/api/chuck/tools</code>
            </div>
            <button onclick="testToolsAPI()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
              Test
            </button>
          </div>
          <p class="text-sm text-gray-600">Lista wszystkich 140+ narzƒôdzi AI</p>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-2">
              <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm font-mono">POST</span>
              <code class="text-sm">/api/chuck/analyze</code>
            </div>
            <button onclick="testAnalyzeAPI()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
              Test
            </button>
          </div>
          <p class="text-sm text-gray-600">Analiza workflow + scoring (DAG, kompatybilno≈õƒá)</p>
        </div>

        <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
          <div class="flex items-center justify-between mb-2">
            <div class="flex items-center gap-2">
              <span class="bg-blue-100 text-blue-700 px-2 py-1 rounded text-sm font-mono">POST</span>
              <code class="text-sm">/api/chuck/exec</code>
            </div>
            <button onclick="testExecAPI()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
              Test
            </button>
          </div>
          <p class="text-sm text-gray-600">Wykonanie narzƒôdzia AI przez CHUCK proxy</p>
        </div>
      </div>
    </section>

    <!-- Results -->
    <section>
      <h2 class="text-2xl font-bold mb-4">üìä Wyniki API</h2>
      <div id="results" class="bg-gray-50 border-2 border-gray-200 rounded-lg p-4 min-h-[200px]">
        <p class="text-gray-500 italic">Kliknij przycisk "Test" aby zobaczyƒá wyniki...</p>
      </div>
    </section>

    <!-- Documentation Link -->
    <div class="mt-8 bg-blue-50 border-2 border-blue-200 rounded-lg p-6">
      <h3 class="font-bold text-lg mb-2">üìö Dokumentacja</h3>
      <p class="mb-3">Pe≈Çna dokumentacja CHUCK Scoring Engine dostƒôpna w repozytorium:</p>
      <a href="https://github.com/Bonzokoles/luc-de-zen-on/blob/main/docs/CHUCK_SCORING_ENGINE.md" 
         target="_blank"
         class="text-blue-600 hover:underline">
        docs/CHUCK_SCORING_ENGINE.md ‚Üí
      </a>
    </div>
  </div>

  <script>
    async function testToolsAPI() {
      showLoading();
      try {
        const response = await fetch('/api/chuck/tools');
        const data = await response.json();
        displayResults(data);
      } catch (error) {
        displayError(error);
      }
    }

    async function testAnalyzeAPI() {
      showLoading();
      try {
        const sampleWorkflow = {
          id: 'test-001',
          name: 'Test Workflow',
          nodes: [
            { id: 'node1', type: 'AI_AGENT', config: { toolId: 'perplexity' } },
            { id: 'node2', type: 'AI_AGENT', config: { toolId: 'jasper' } },
            { id: 'node3', type: 'OUTPUT', config: { destination: 'email', target: 'test@test.com' } }
          ],
          connections: [
            { from: 'node1', to: 'node2' },
            { from: 'node2', to: 'node3' }
          ]
        };

        const response = await fetch('/api/chuck/analyze', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            workflow: sampleWorkflow,
            options: {
              includeRecommendations: true,
              includeCompatibility: true,
              includeExecutionPlan: true
            }
          })
        });
        const data = await response.json();
        displayResults(data);
      } catch (error) {
        displayError(error);
      }
    }

    async function testExecAPI() {
      showLoading();
      try {
        const response = await fetch('/api/chuck/exec', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            toolId: 'cursor',
            prompt: 'Write a hello world function',
            parameters: { language: 'javascript' }
          })
        });
        const data = await response.json();
        displayResults(data);
      } catch (error) {
        displayError(error);
      }
    }

    function showLoading() {
      const results = document.getElementById('results');
      if (results) {
        results.innerHTML = '<p class="text-blue-600 italic">≈Åadowanie...</p>';
      }
    }

    function displayResults(data) {
      const results = document.getElementById('results');
      if (results) {
        results.innerHTML = `<pre class="text-sm overflow-auto">${JSON.stringify(data, null, 2)}</pre>`;
      }
    }

    function displayError(error) {
      const results = document.getElementById('results');
      if (results) {
        results.innerHTML = `<p class="text-red-600">Error: ${error.message}</p>`;
      }
    }
  </script>
</MainLayout>
