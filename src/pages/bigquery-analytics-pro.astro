---
import type { HTMLAttributes } from "astro/types";
import MyBonzoLayout from "../layouts/MyBonzoLayout.astro";

interface Props extends HTMLAttributes<"div"> {
  title?: string;
  description?: string;
}

const { 
  title = "BigQuery Analytics Pro | MyBonzo AI Platform",
  description = "Zaawansowana analityka BigQuery z pe≈Çnymi instrukcjami, przyk≈Çadami SQL i integracjƒÖ Google Cloud",
  ...attrs 
} = Astro.props;

// Metadata for SEO
const metadata = {
  title,
  description,
  canonical: new URL(Astro.url.pathname, Astro.site),
  type: "website",
  features: [
    "Complete BigQuery Tutorial",
    "SQL Query Examples & Templates", 
    "Google Cloud Integration Guide",
    "Polish Datasets Access",
    "Cost Optimization Tips",
    "Real-time Analytics Dashboard"
  ]
};
---

<MyBonzoLayout title={metadata.title} description={metadata.description}>
  <main class="min-h-svh bg-gradient-to-br from-gray-900 via-blue-900 to-purple-900">
    
    <!-- Enhanced Header with Tutorial Toggle -->
    <section class="border border-edge">
      <div class="max-w-7xl mx-auto border-x border-edge">
        <div class="flex justify-between items-center max-h-72 min-h-64 p-6">
          <div class="flex items-end gap-8">
            <span style="writing-mode: vertical-lr;" class="text-edge block px-2 text-xl font-semibold tracking-[0.3em]">
              BIGQUERY
            </span>
            <div>
              <h1 class="text-4xl sm:text-5xl font-bold text-primary-foreground">BIGQUERY ANALYTICS PRO</h1>
              <h2 class="text-2xl sm:text-3xl text-blue-300">Kompletny przewodnik i narzƒôdzia</h2>
            </div>
          </div>
          <div class="flex flex-col gap-3">
            <button id="tutorialToggle" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-semibold transition-colors">
              üìö Poka≈º instrukcje
            </button>
            <a href="/bigquery-analytics" class="px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded font-semibold transition-colors text-center">
              ‚ö° Wersja podstawowa
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Tutorial Section - Hidden by default -->
    <section id="tutorialSection" class="tutorial-section hidden border border-edge bg-gradient-to-r from-blue-900/30 to-purple-900/30">
      <div class="max-w-7xl mx-auto p-8">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
          
          <!-- Left Column: Getting Started -->
          <div class="space-y-6">
            <div class="tutorial-card bg-black/40 border border-edge rounded-lg p-6">
              <h3 class="text-2xl font-bold text-blue-300 mb-4">üöÄ Pierwsze kroki z BigQuery</h3>
              
              <div class="space-y-4">
                <div class="step">
                  <h4 class="text-lg font-semibold text-white mb-2">1. Konfiguracja Google Cloud</h4>
                  <ul class="text-gray-300 space-y-1 ml-4">
                    <li>‚Ä¢ Stw√≥rz konto Google Cloud (300$ darmowych kredyt√≥w)</li>
                    <li>‚Ä¢ W≈ÇƒÖcz BigQuery API w Console</li>
                    <li>‚Ä¢ Stw√≥rz projekt i dataset</li>
                  </ul>
                </div>

                <div class="step">
                  <h4 class="text-lg font-semibold text-white mb-2">2. Darmowe zbiory danych</h4>
                  <ul class="text-gray-300 space-y-1 ml-4">
                    <li>‚Ä¢ <span class="text-blue-300 font-mono">bigquery-public-data</span> - publiczne datasety</li>
                    <li>‚Ä¢ <span class="text-blue-300 font-mono">covid19_public_data</span> - dane COVID-19</li>
                    <li>‚Ä¢ <span class="text-blue-300 font-mono">chicago_taxi_trips</span> - dane transportowe</li>
                  </ul>
                </div>

                <div class="step">
                  <h4 class="text-lg font-semibold text-white mb-2">3. Polskie dane</h4>
                  <ul class="text-gray-300 space-y-1 ml-4">
                    <li>‚Ä¢ GUS API integration</li>
                    <li>‚Ä¢ NBP kursy walut</li>
                    <li>‚Ä¢ Dane gie≈Çdowe GPW</li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- Cost Optimization Tips -->
            <div class="tutorial-card bg-black/40 border border-edge rounded-lg p-6">
              <h3 class="text-2xl font-bold text-green-300 mb-4">üí∞ Optymalizacja koszt√≥w</h3>
              <div class="space-y-3 text-gray-300">
                <p><strong class="text-white">Slot reservations:</strong> Dla regularnych workload√≥w</p>
                <p><strong class="text-white">Partitioning:</strong> Dziel du≈ºe tabele wed≈Çug daty</p>
                <p><strong class="text-white">Clustering:</strong> Grupuj wed≈Çug czƒôsto u≈ºywanych kolumn</p>
                <p><strong class="text-white">SELECT *:</strong> Zawsze specyfikuj potrzebne kolumny</p>
                <div class="bg-red-900/30 border border-red-500 rounded p-3 mt-4">
                  <p class="text-red-300"><strong>‚ö†Ô∏è Uwaga:</strong> Pe≈Çne skanowanie tabeli mo≈ºe kosztowaƒá setki dolar√≥w!</p>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column: SQL Examples -->
          <div class="space-y-6">
            <div class="tutorial-card bg-black/40 border border-edge rounded-lg p-6">
              <h3 class="text-2xl font-bold text-purple-300 mb-4">üìù Przyk≈Çady SQL</h3>
              
              <div class="space-y-4">
                <div class="sql-example">
                  <h4 class="text-white font-semibold mb-2">Podstawowe zapytanie:</h4>
                  <pre class="bg-gray-900 border border-gray-700 rounded p-3 text-sm text-green-400 overflow-x-auto"><code>SELECT 
  user_id,
  COUNT(*) as total_sessions,
  AVG(session_duration) as avg_duration
FROM `project.dataset.sessions`
WHERE date >= '2024-01-01'
GROUP BY user_id
ORDER BY total_sessions DESC
LIMIT 100;</code></pre>
                </div>

                <div class="sql-example">
                  <h4 class="text-white font-semibold mb-2">Window functions:</h4>
                  <pre class="bg-gray-900 border border-gray-700 rounded p-3 text-sm text-green-400 overflow-x-auto"><code>SELECT 
  date,
  revenue,
  SUM(revenue) OVER (
    ORDER BY date 
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) as rolling_7day_revenue
FROM `project.dataset.daily_revenue`
ORDER BY date;</code></pre>
                </div>

                <div class="sql-example">
                  <h4 class="text-white font-semibold mb-2">JSON parsing:</h4>
                  <pre class="bg-gray-900 border border-gray-700 rounded p-3 text-sm text-green-400 overflow-x-auto"><code>SELECT 
  event_name,
  JSON_EXTRACT_SCALAR(event_params, '$.value') as param_value,
  COUNT(*) as occurrences
FROM `project.analytics.events_*`
WHERE _TABLE_SUFFIX BETWEEN '20240101' AND '20240131'
GROUP BY 1, 2;</code></pre>
                </div>
              </div>
            </div>

            <!-- Performance Tips -->
            <div class="tutorial-card bg-black/40 border border-edge rounded-lg p-6">
              <h3 class="text-2xl font-bold text-yellow-300 mb-4">‚ö° Wydajno≈õƒá</h3>
              <div class="space-y-3 text-gray-300">
                <p><strong class="text-white">Materialized Views:</strong> Cache dla czƒôsto u≈ºywanych zapyta≈Ñ</p>
                <p><strong class="text-white">Approximate functions:</strong> APPROX_COUNT_DISTINCT() dla du≈ºych zbior√≥w</p>
                <p><strong class="text-white">Cached results:</strong> BigQuery cachuje wyniki na 24h</p>
                <p><strong class="text-white">Streaming inserts:</strong> Dla real-time analytics</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Analytics Interface -->
    <section class="max-w-7xl mx-auto p-8">
      <div class="grid grid-cols-1 xl:grid-cols-4 gap-6">
        
        <!-- Query Builder -->
        <div class="xl:col-span-3">
          <div class="bg-black/30 border border-edge rounded-lg">
            <div class="border-b border-edge p-4 flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="w-3 h-3 bg-blue-400 rounded-full animate-pulse"></div>
                <h3 class="text-xl font-semibold text-white">BigQuery Console Pro</h3>
              </div>
              <div class="flex gap-2">
                <button class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm">Zapisz</button>
                <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm">Template</button>
                <button class="px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm">AI Help</button>
              </div>
            </div>

            <!-- Enhanced Query Editor -->
            <div class="p-4">
              <div class="grid grid-cols-1 lg:grid-cols-4 gap-4 mb-4">
                <div>
                  <label class="block text-sm font-medium mb-2 text-white">Projekt:</label>
                  <select class="w-full p-2 bg-black/50 border border-edge rounded text-white">
                    <option>mybonzo-analytics</option>
                    <option>bigquery-public-data</option>
                    <option>covid19_public_data</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium mb-2 text-white">Dataset:</label>
                  <select class="w-full p-2 bg-black/50 border border-edge rounded text-white">
                    <option>analytics</option>
                    <option>usa_names</option>
                    <option>chicago_taxi_trips</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium mb-2 text-white">Tabela:</label>
                  <select class="w-full p-2 bg-black/50 border border-edge rounded text-white">
                    <option>events</option>
                    <option>users</option>
                    <option>sessions</option>
                  </select>
                </div>
                <div>
                  <label class="block text-sm font-medium mb-2 text-white">Template:</label>
                  <select id="queryTemplate" class="w-full p-2 bg-black/50 border border-edge rounded text-white">
                    <option value="">Wybierz szablon</option>
                    <option value="basic">Podstawowe SELECT</option>
                    <option value="analytics">Analityka u≈ºytkownik√≥w</option>
                    <option value="time_series">Analiza czasowa</option>
                    <option value="funnel">Lejek konwersji</option>
                  </select>
                </div>
              </div>

              <!-- Query Editor with Line Numbers -->
              <div class="relative">
                <div class="flex">
                  <div class="bg-gray-800 border-r border-gray-600 p-3 text-gray-400 text-sm font-mono leading-relaxed min-w-[3rem] text-right">
                    <div>1</div><div>2</div><div>3</div><div>4</div><div>5</div><div>6</div><div>7</div><div>8</div>
                  </div>
                  <textarea
                    id="sqlQuery"
                    rows="8"
                    class="flex-1 p-3 bg-gray-900 text-green-400 font-mono text-sm border-none outline-none resize-none"
                    placeholder="-- Wpisz zapytanie SQL lub wybierz szablon
SELECT *
FROM `project.dataset.table`
WHERE date >= CURRENT_DATE()
LIMIT 100;"
                  ></textarea>
                </div>
                <div class="absolute top-2 right-2 text-xs text-gray-400" id="queryStats">
                  Szacowany koszt: $0.00 | Bytes: 0
                </div>
              </div>

              <!-- Query Actions -->
              <div class="flex items-center justify-between mt-4 p-3 bg-black/40 rounded">
                <div class="flex gap-3">
                  <button 
                    id="executeQuery"
                    class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded font-semibold transition-colors"
                  >
                    ‚ñ∂Ô∏è Wykonaj
                  </button>
                  <button class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors">
                    üîç Wyja≈õnij AI
                  </button>
                  <button class="px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded transition-colors">
                    ‚ö° Optymalizuj
                  </button>
                </div>
                <div class="text-sm text-gray-400">
                  Dry run: <span class="text-green-400">‚úì</span> | 
                  Cache: <span class="text-blue-400">24h</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Results Section -->
          <div id="resultsSection" class="mt-6 bg-black/30 border border-edge rounded-lg hidden">
            <div class="border-b border-edge p-4">
              <div class="flex items-center justify-between">
                <h3 class="text-lg font-semibold text-white">Wyniki zapytania</h3>
                <div class="flex gap-2">
                  <button class="px-3 py-1 bg-green-600 hover:bg-green-700 text-white rounded text-sm">üìä Wykres</button>
                  <button class="px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm">üì• CSV</button>
                  <button class="px-3 py-1 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm">üîó Share</button>
                </div>
              </div>
            </div>
            <div id="queryResults" class="p-4">
              <!-- Results will be populated here -->
            </div>
          </div>
        </div>

        <!-- Right Sidebar -->
        <div class="xl:col-span-1 space-y-6">
          
          <!-- Schema Browser -->
          <div class="bg-black/30 border border-edge rounded-lg">
            <div class="border-b border-edge p-4">
              <h3 class="text-lg font-semibold text-white">üìã Schema Browser</h3>
            </div>
            <div class="p-4 space-y-2">
              <div class="schema-item">
                <div class="text-blue-300 font-semibold cursor-pointer">üìä analytics</div>
                <div class="ml-4 space-y-1">
                  <div class="text-gray-300 cursor-pointer hover:text-white">üìÑ events</div>
                  <div class="text-gray-300 cursor-pointer hover:text-white">üë• users</div>
                  <div class="text-gray-300 cursor-pointer hover:text-white">üîó sessions</div>
                </div>
              </div>
              <div class="schema-item">
                <div class="text-blue-300 font-semibold cursor-pointer">üè¢ public_data</div>
                <div class="ml-4 space-y-1">
                  <div class="text-gray-300 cursor-pointer hover:text-white">üåç usa_names</div>
                  <div class="text-gray-300 cursor-pointer hover:text-white">üöï chicago_taxi</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Query History -->
          <div class="bg-black/30 border border-edge rounded-lg">
            <div class="border-b border-edge p-4">
              <h3 class="text-lg font-semibold text-white">üïí Historia zapyta≈Ñ</h3>
            </div>
            <div class="p-4 space-y-2">
              <div class="history-item p-2 bg-black/40 rounded cursor-pointer hover:bg-black/60">
                <div class="text-green-400 text-sm font-mono">SELECT COUNT(*) FROM events</div>
                <div class="text-xs text-gray-400">2 min temu ‚Ä¢ $0.001</div>
              </div>
              <div class="history-item p-2 bg-black/40 rounded cursor-pointer hover:bg-black/60">
                <div class="text-green-400 text-sm font-mono">SELECT user_id, COUNT...</div>
                <div class="text-xs text-gray-400">15 min temu ‚Ä¢ $0.05</div>
              </div>
            </div>
          </div>

          <!-- Performance Metrics -->
          <div class="bg-black/30 border border-edge rounded-lg">
            <div class="border-b border-edge p-4">
              <h3 class="text-lg font-semibold text-white">üìà Metryki</h3>
            </div>
            <div class="p-4 space-y-3">
              <div class="flex justify-between">
                <span class="text-gray-300">Zapytania dzisiaj:</span>
                <span class="text-blue-400 font-mono">47</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-300">Koszt dzisiaj:</span>
                <span class="text-green-400 font-mono">$2.34</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-300">Dane przetworzone:</span>
                <span class="text-purple-400 font-mono">1.2 GB</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-300">≈öredni czas:</span>
                <span class="text-orange-400 font-mono">2.4s</span>
              </div>
            </div>
          </div>

          <!-- Quick Actions -->
          <div class="bg-black/30 border border-edge rounded-lg">
            <div class="border-b border-edge p-4">
              <h3 class="text-lg font-semibold text-white">‚ö° Szybkie akcje</h3>
            </div>
            <div class="p-4 space-y-2">
              <button class="w-full p-2 bg-blue-600 hover:bg-blue-700 text-white rounded text-sm transition-colors">
                üìä Dashboard Analytics
              </button>
              <button class="w-full p-2 bg-green-600 hover:bg-green-700 text-white rounded text-sm transition-colors">
                üìà Data Studio
              </button>
              <button class="w-full p-2 bg-purple-600 hover:bg-purple-700 text-white rounded text-sm transition-colors">
                ü§ñ AI Insights
              </button>
              <button class="w-full p-2 bg-orange-600 hover:bg-orange-700 text-white rounded text-sm transition-colors">
                üìã Export Report
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</MyBonzoLayout>

<script>
  // Tutorial toggle functionality
  document.getElementById('tutorialToggle').addEventListener('click', function() {
    const tutorialSection = document.getElementById('tutorialSection');
    const button = this;
    
    if (tutorialSection.classList.contains('hidden')) {
      tutorialSection.classList.remove('hidden');
      button.textContent = 'üìö Ukryj instrukcje';
      button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
      button.classList.add('bg-red-600', 'hover:bg-red-700');
    } else {
      tutorialSection.classList.add('hidden');
      button.textContent = 'üìö Poka≈º instrukcje';
      button.classList.remove('bg-red-600', 'hover:bg-red-700');
      button.classList.add('bg-blue-600', 'hover:bg-blue-700');
    }
  });

  // Query templates
  const templates = {
    basic: `-- Podstawowe zapytanie SELECT
SELECT 
  column1,
  column2,
  COUNT(*) as total_records
FROM \`project.dataset.table\`
WHERE date >= CURRENT_DATE()
GROUP BY column1, column2
ORDER BY total_records DESC
LIMIT 100;`,
    
    analytics: `-- Analityka u≈ºytkownik√≥w
SELECT 
  user_id,
  COUNT(DISTINCT session_id) as sessions,
  COUNT(DISTINCT DATE(event_timestamp)) as active_days,
  SUM(event_count) as total_events,
  AVG(session_duration_minutes) as avg_session_duration
FROM \`project.analytics.user_sessions\`
WHERE DATE(event_timestamp) BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY) AND CURRENT_DATE()
GROUP BY user_id
HAVING sessions >= 5
ORDER BY total_events DESC;`,
    
    time_series: `-- Analiza czasowa z trendem
WITH daily_metrics AS (
  SELECT 
    DATE(event_timestamp) as date,
    COUNT(*) as daily_events,
    COUNT(DISTINCT user_id) as daily_users
  FROM \`project.analytics.events\`
  WHERE DATE(event_timestamp) >= DATE_SUB(CURRENT_DATE(), INTERVAL 90 DAY)
  GROUP BY DATE(event_timestamp)
)
SELECT 
  date,
  daily_events,
  daily_users,
  AVG(daily_events) OVER (
    ORDER BY date 
    ROWS BETWEEN 6 PRECEDING AND CURRENT ROW
  ) as events_7day_avg,
  LAG(daily_events, 7) OVER (ORDER BY date) as events_week_ago
FROM daily_metrics
ORDER BY date;`,
    
    funnel: `-- Lejek konwersji
WITH funnel_steps AS (
  SELECT 
    user_id,
    MAX(CASE WHEN event_name = 'page_view' THEN 1 ELSE 0 END) as step1_view,
    MAX(CASE WHEN event_name = 'add_to_cart' THEN 1 ELSE 0 END) as step2_cart,
    MAX(CASE WHEN event_name = 'begin_checkout' THEN 1 ELSE 0 END) as step3_checkout,
    MAX(CASE WHEN event_name = 'purchase' THEN 1 ELSE 0 END) as step4_purchase
  FROM \`project.analytics.events\`
  WHERE DATE(event_timestamp) = CURRENT_DATE()
  GROUP BY user_id
)
SELECT 
  'Step 1: Page View' as step,
  SUM(step1_view) as users,
  ROUND(SUM(step1_view) / SUM(step1_view) * 100, 2) as conversion_rate
FROM funnel_steps
UNION ALL
SELECT 
  'Step 2: Add to Cart',
  SUM(step2_cart),
  ROUND(SUM(step2_cart) / SUM(step1_view) * 100, 2)
FROM funnel_steps
UNION ALL
SELECT 
  'Step 3: Begin Checkout',
  SUM(step3_checkout),
  ROUND(SUM(step3_checkout) / SUM(step1_view) * 100, 2)
FROM funnel_steps
UNION ALL
SELECT 
  'Step 4: Purchase',
  SUM(step4_purchase),
  ROUND(SUM(step4_purchase) / SUM(step1_view) * 100, 2)
FROM funnel_steps;`
  };

  // Template selection
  document.getElementById('queryTemplate').addEventListener('change', function() {
    const template = templates[this.value];
    if (template) {
      document.getElementById('sqlQuery').value = template;
      updateQueryStats();
    }
  });

  // Query execution
  document.getElementById('executeQuery').addEventListener('click', async function() {
    const query = document.getElementById('sqlQuery').value.trim();
    if (!query) {
      alert('Wprowad≈∫ zapytanie SQL');
      return;
    }

    this.disabled = true;
    this.textContent = '‚è≥ Wykonywanie...';

    try {
      const response = await fetch('/api/bigquery', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ query })
      });

      const result = await response.json();

      if (result.status === 'success') {
        displayResults(result);
        document.getElementById('resultsSection').classList.remove('hidden');
      } else {
        alert('B≈ÇƒÖd wykonania zapytania: ' + result.error);
      }
    } catch (error) {
      alert('B≈ÇƒÖd po≈ÇƒÖczenia: ' + error.message);
    } finally {
      this.disabled = false;
      this.textContent = '‚ñ∂Ô∏è Wykonaj';
    }
  });

  function displayResults(result) {
    const resultsDiv = document.getElementById('queryResults');
    
    if (result.results && result.results.length > 0) {
      // Create table
      const table = document.createElement('table');
      table.className = 'w-full text-sm';
      
      // Headers
      const thead = document.createElement('thead');
      const headerRow = document.createElement('tr');
      headerRow.className = 'border-b border-gray-600';
      
      Object.keys(result.results[0]).forEach(key => {
        const th = document.createElement('th');
        th.className = 'text-left p-2 text-blue-300 font-semibold';
        th.textContent = key;
        headerRow.appendChild(th);
      });
      
      thead.appendChild(headerRow);
      table.appendChild(thead);
      
      // Body
      const tbody = document.createElement('tbody');
      result.results.forEach((row, index) => {
        const tr = document.createElement('tr');
        tr.className = index % 2 === 0 ? 'bg-black/20' : 'bg-black/10';
        
        Object.values(row).forEach(value => {
          const td = document.createElement('td');
          td.className = 'p-2 text-gray-300';
          td.textContent = value;
          tr.appendChild(td);
        });
        
        tbody.appendChild(tr);
      });
      
      table.appendChild(tbody);
      
      resultsDiv.innerHTML = `
        <div class="mb-4 p-3 bg-green-900/30 border border-green-500 rounded">
          <div class="text-green-300 font-semibold mb-1">Zapytanie wykonane pomy≈õlnie!</div>
          <div class="text-sm text-gray-300">
            Wiersze: ${result.rowCount} | 
            Czas: ${result.executionTime} | 
            Dane: ${result.bytesProcessed}
          </div>
        </div>
        <div class="overflow-x-auto max-h-96">
        </div>
      `;
      
      resultsDiv.querySelector('.overflow-x-auto').appendChild(table);
    }
  }

  function updateQueryStats() {
    const query = document.getElementById('sqlQuery').value;
    const estimatedBytes = query.length * 100; // Simple estimation
    const estimatedCost = (estimatedBytes / 1000000000 * 5).toFixed(4); // $5 per TB
    
    document.getElementById('queryStats').textContent = 
      `Szacowany koszt: $${estimatedCost} | Bytes: ${estimatedBytes.toLocaleString()}`;
  }

  // Update stats on query change
  document.getElementById('sqlQuery').addEventListener('input', updateQueryStats);

  // Initialize
  updateQueryStats();
</script>

<style>
  .tutorial-section {
    animation: slideDown 0.3s ease-out;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .tutorial-card {
    backdrop-filter: blur(10px);
  }

  .sql-example pre {
    font-size: 0.875rem;
    line-height: 1.4;
  }

  .schema-item .text-blue-300:hover {
    color: #93c5fd;
  }

  .history-item {
    transition: all 0.2s ease;
  }

  #sqlQuery {
    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
    line-height: 1.5;
  }

  /* Custom scrollbar */
  .overflow-x-auto::-webkit-scrollbar {
    height: 8px;
  }

  .overflow-x-auto::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.3);
  }

  .overflow-x-auto::-webkit-scrollbar-thumb {
    background: rgba(59, 130, 246, 0.5);
    border-radius: 4px;
  }

  .overflow-x-auto::-webkit-scrollbar-thumb:hover {
    background: rgba(59, 130, 246, 0.7);
  }
</style>