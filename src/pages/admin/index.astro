---
import UniversalPageLayout from "../../layouts/UniversalPageLayout.astro";
import GlassPanel from "../../layouts/components/GlassPanel.astro";
import CyberpunkButton from "../../layouts/components/CyberpunkButton.astro";

const pageTitle = "Dashboard Admin | MyBonzo";
const pageDescription = "GÅ‚Ã³wny panel administracyjny systemu MyBonzo AI";
const pageQuote = "Kontrola i zarzÄ…dzanie systemem w jednym miejscu.";
const pageAuthor = "MyBonzo Team";
---

<UniversalPageLayout 
  pageTitle={pageTitle}
  pageDescription={pageDescription}
  pageQuote={pageQuote}
  pageAuthor={pageAuthor}
  showRandomQuote={false}
>
    <!-- Admin Hub Overview -->
    <GlassPanel title="ğŸ  Centrum Administracyjne MyBonzo" variant="highlight" padding="xl">
        <div style="text-align: center; margin-bottom: 30px;">
            <div style="color: rgba(255,255,255,0.9); font-size: 1.2rem; margin-bottom: 20px;">
                Witaj w centrum kontroli systemu MyBonzo AI. Wybierz obszar zarzÄ…dzania:
            </div>
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px;">
            <!-- Quick Login Panel -->
            <div style="background: rgba(0,217,255,0.1); border: 2px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 25px; text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 15px;">ğŸ”</div>
                <h3 style="color: #00d9ff; margin-bottom: 15px; font-size: 1.4rem;">Panel Logowania</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Szybki dostÄ™p do panelu administracyjnego z autoryzacjÄ…
                </p>
                <CyberpunkButton 
                    text="PrzejdÅº do logowania" 
                    variant="primary" 
                    size="md"
                    onclick="window.location.href='/admin/login'"
                />
            </div>

            <!-- Advanced Dashboard -->
            <div style="background: rgba(0,217,255,0.1); border: 2px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 25px; text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 15px;">ğŸ“Š</div>
                <h3 style="color: #00d9ff; margin-bottom: 15px; font-size: 1.4rem;">Zaawansowany Dashboard</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Kompleksowy panel z monitoringiem i zarzÄ…dzaniem
                </p>
                <CyberpunkButton 
                    text="OtwÃ³rz Dashboard" 
                    variant="primary" 
                    size="md"
                    onclick="window.location.href='/admin/dashboard'"
                />
            </div>

            <!-- Admin AI Assistant -->
            <div style="background: rgba(0,217,255,0.1); border: 2px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 25px; text-align: center;">
                <div style="font-size: 3rem; margin-bottom: 15px;">ğŸ¤–</div>
                <h3 style="color: #00d9ff; margin-bottom: 15px; font-size: 1.4rem;">Admin AI Assistant</h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 20px;">
                    Inteligentny asystent dla zadaÅ„ administracyjnych
                </p>
                <CyberpunkButton 
                    text="Rozpocznij Chat" 
                    variant="primary" 
                    size="md"
                    onclick="window.location.href='/admin/ai-chat'"
                />
            </div>
        </div>
    </GlassPanel>

    <!-- Quick Access Menu -->
    <GlassPanel title="âš¡ Szybki dostÄ™p" variant="default" padding="lg">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
            
            <!-- System Monitoring -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ“Š <span style="margin-left: 10px;">Monitoring systemu</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    Monitoruj wydajnoÅ›Ä‡, status workerÃ³w i logi systemowe
                </p>
                <CyberpunkButton 
                    text="Zobacz status" 
                    variant="outline" 
                    size="sm"
                    onclick="window.location.href='/admin/monitoring'"
                />
            </div>

            <!-- User Management -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ‘¥ <span style="margin-left: 10px;">ZarzÄ…dzanie uÅ¼ytkownikami</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    PrzeglÄ…daj, edytuj i zarzÄ…dzaj kontami uÅ¼ytkownikÃ³w
                </p>
                <CyberpunkButton 
                    text="ZarzÄ…dzaj" 
                    variant="outline" 
                    size="sm"
                    onclick="window.location.href='/admin/users'"
                />
            </div>

            <!-- AI Models -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ¤– <span style="margin-left: 10px;">Modele AI</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    Konfiguruj i zarzÄ…dzaj modelami sztucznej inteligencji
                </p>
                <div style="display: flex; gap: 8px;">
                    <CyberpunkButton 
                        text="Konfiguruj" 
                        variant="outline" 
                        size="sm"
                        onclick="window.location.href='/admin/ai-models'"
                    />
                    <CyberpunkButton 
                        text="AI Chat" 
                        variant="primary" 
                        size="sm"
                        onclick="window.location.href='/admin/ai-chat'"
                    />
                </div>
            </div>

            <!-- Security Center -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ”’ <span style="margin-left: 10px;">Centrum bezpieczeÅ„stwa</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    Konfiguruj zabezpieczenia i kontrolÄ™ dostÄ™pu
                </p>
                <CyberpunkButton 
                    text="Zabezpieczenia" 
                    variant="outline" 
                    size="sm"
                    onclick="window.location.href='/admin/security'"
                />
            </div>

            <!-- Database Management -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ—„ï¸ <span style="margin-left: 10px;">Baza danych</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    ZarzÄ…dzaj bazÄ… danych i wykonuj kopie zapasowe
                </p>
                <CyberpunkButton 
                    text="ZarzÄ…dzaj" 
                    variant="outline" 
                    size="sm"
                    onclick="window.location.href='/admin/database'"
                />
            </div>

            <!-- API Management -->
            <div style="background: rgba(0,0,0,0.4); border: 1px solid rgba(0,217,255,0.3); border-radius: 12px; padding: 20px;">
                <h3 style="color: #00d9ff; margin-bottom: 15px; display: flex; align-items: center;">
                    ğŸ”Œ <span style="margin-left: 10px;">API Management</span>
                </h3>
                <p style="color: rgba(255,255,255,0.7); margin-bottom: 15px; font-size: 0.9rem;">
                    ZarzÄ…dzaj kluczami API i limitami zapytaÅ„
                </p>
                <CyberpunkButton 
                    text="Konfiguruj API" 
                    variant="outline" 
                    size="sm"
                    onclick="window.location.href='/admin/api'"
                />
            </div>
        </div>
    </GlassPanel>

    <!-- System Status Overview -->
    <GlassPanel title="ğŸ“ˆ PrzeglÄ…d systemu" variant="success" padding="lg">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
            <div style="background: rgba(0,217,255,0.1); padding: 15px; border: 1px solid rgba(0,217,255,0.3); border-radius: 8px; text-align: center;">
                <div style="color: #00d9ff; font-size: 2rem; font-weight: 700;" id="systemStatus">ğŸŸ¢ ONLINE</div>
                <div style="color: rgba(255,255,255,0.7);">Status systemu</div>
            </div>
            <div style="background: rgba(0,217,255,0.1); padding: 15px; border: 1px solid rgba(0,217,255,0.3); border-radius: 8px; text-align: center;">
                <div style="color: #00d9ff; font-size: 2rem; font-weight: 700;" id="activeWorkers">8/10</div>
                <div style="color: rgba(255,255,255,0.7);">Aktywne workery</div>
            </div>
            <div style="background: rgba(0,217,255,0.1); padding: 15px; border: 1px solid rgba(0,217,255,0.3); border-radius: 8px; text-align: center;">
                <div style="color: #00d9ff; font-size: 2rem; font-weight: 700;" id="uptime">99.8%</div>
                <div style="color: rgba(255,255,255,0.7);">Uptime 24h</div>
            </div>
            <div style="background: rgba(0,217,255,0.1); padding: 15px; border: 1px solid rgba(0,217,255,0.3); border-radius: 8px; text-align: center;">
                <div style="color: #00d9ff; font-size: 2rem; font-weight: 700;" id="totalRequests">12.4k</div>
                <div style="color: rgba(255,255,255,0.7);">Zapytania dzisiaj</div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 25px; display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
            <CyberpunkButton 
                text="ğŸ”„ OdÅ›wieÅ¼ dane" 
                variant="outline" 
                size="md"
                onclick="updateSystemStats()"
            />
        </div>
    </GlassPanel>

    <script>
        // System stats update function
        async function updateSystemStats() {
            try {
                // Pobieranie prawdziwych statystyk z API
                const response = await fetch('/api/admin/stats', {
                    headers: {
                        'Authorization': 'Bearer HAOS77'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Aktualizacja wyÅ›wietlanych statystyk
                    const activeWorkers = Math.min(data.activeUsers || 0, 10); // max 10 workers
                    document.getElementById('activeWorkers').textContent = `${activeWorkers}/10`;
                    
                    const uptime = typeof data.uptime === 'string' 
                        ? data.uptime.replace('%', '') 
                        : (data.uptime || 99.8);
                    document.getElementById('uptime').textContent = `${uptime}%`;
                    
                    const requestsK = ((data.totalAPIRequests || 0) / 1000).toFixed(1);
                    document.getElementById('totalRequests').textContent = `${requestsK}k`;
                } else {
                    // Fallback values jeÅ›li API nie dziaÅ‚a
                    document.getElementById('activeWorkers').textContent = '8/10';
                    document.getElementById('uptime').textContent = '99.8%';
                    document.getElementById('totalRequests').textContent = '12.4k';
                }
            } catch (error) {
                console.error('Error fetching system stats:', error);
                // Fallback values w przypadku bÅ‚Ä™du
                document.getElementById('activeWorkers').textContent = 'N/A';
                document.getElementById('uptime').textContent = 'N/A';
                document.getElementById('totalRequests').textContent = 'N/A';
            }

            // Show update confirmation
            const button = document.querySelector('[onclick="updateSystemStats()"]');
            const originalText = button.textContent;
            button.textContent = 'âœ… Zaktualizowano';
            button.style.color = '#22c55e';
            
            setTimeout(() => {
                button.textContent = originalText;
                button.style.color = '';
            }, 2000);
        }

        // Auto-update every 60 seconds
        setInterval(updateSystemStats, 60000);

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            // Initial stats load
            updateSystemStats();
        });
    </script>
</UniversalPageLayout>