---
// Uniwersalny layout dla wszystkich podstron
// Zawiera: floating menu, RandomQuote, białe linie, przezroczyste panele

// Critical polyfill for React SSR on Cloudflare Workers
import '../polyfills/react-scheduler.js';

// React fix for browser environment
import '../polyfills/react-fix.js';

// Import other polyfills for Cloudflare Workers
import "../utils/polyfills.js";
import "../styles/global.css";
import BgAnimation from "../components/BgAnimation.svelte";
import PageTransition from "../components/PageTransition.svelte";
import RandomQuote from "../components/RandomQuote.astro";
<<<<<<< HEAD
import Header from "@sofidevo/astro-dynamic-header/Header";
        logoAlt={siteTitle}
        logoWidth="24px"
        homeUrl="/"
        menuItems={menuItems}
        backgroundColor="#0d0d0dcc"
        backdropBlur="blur(16px)"
        zIndex={20}
      />
    </div>
=======
>>>>>>> c1c4ac5534f2943dcdcdd273d347cf64339cc1a7

// Universal navigation menu
const menuItems = [
  { link: "/", text: "Strona główna" },
  {
    link: "/#ai-workers", 
    text: "AI Workers",
    submenu: [
      { link: "/ai-workers-manager", text: "Manager" },
      { link: "/agents", text: "Agenci" },
      { link: "/agent-builder-23", text: "Builder" },
    ],
  },
  { link: "/image-generator", text: "Generator obrazów" },
  { link: "/prompt-enhancer", text: "SupaGruen SD" },
  { link: "/quiz", text: "Quiz" },
  { link: "/admin", text: "Panel" },
];
  themeColor?: string;
}

const {
  siteTitle,
  pageTitle = siteTitle,
  pageDescription,
  description = pageDescription || "MyBonzo AI Platform - Inteligentny Asystent",
  pageQuote,
  pageAuthor,
  showRandomQuote = true,
  themeColor = "190",
} = Astro.props;

// Import components
import "../utils/polyfills.js";
import "../styles/global.css";
import BgAnimation from "../components/BgAnimation.svelte";
import PageTransition from "../components/PageTransition.svelte";
import RandomQuote from "../components/RandomQuote.astro";
<<<<<<< HEAD
import Header from "@sofidevo/astro-dynamic-header/Header";
=======
>>>>>>> c1c4ac5534f2943dcdcdd273d347cf64339cc1a7

// Universal navigation menu
const menuItems = [
  { link: "/", text: "Strona główna" },
  {
    link: "/#ai-workers", 
    text: "AI Workers",
    submenu: [
      { link: "/ai-workers-manager", text: "Manager" },
      { link: "/agents", text: "Agenci" },
      { link: "/agent-builder-23", text: "Builder" },
    ],
  },
  { link: "/image-generator", text: "Generator obrazów" },
  { link: "/prompt-enhancer", text: "SupaGruen SD" },
  { link: "/quiz", text: "Quiz" },
  { link: "/admin", text: "Panel" },
];

const pageKey = Astro.url.pathname;
---

<!doctype html>
<html lang="pl">
  <head>
    <!-- Global Metadata -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="sitemap" href="/sitemap-index.xml" />
    <meta name="generator" content="Astro v5.13.5" />

    <!-- Font preloads -->
    <link
      rel="preload"
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Primary Meta Tags -->
    <title>{siteTitle || pageTitle}</title>
    <meta name="title" content={siteTitle || pageTitle} />
    <meta name="description" content={description || pageDescription} />

    <!-- CSS Variables for Theme -->
    <style define:vars={{ themeColor }}>
      :root {
        --theme-hue: var(--themeColor);
        --color-primary: hsl(var(--themeColor), 20%, 8%);
        --color-primary-foreground: hsl(var(--themeColor), 100%, 92%);
        --color-secondary: hsl(var(--themeColor), 40%, 12%);
        --color-accent: hsl(var(--themeColor), 100%, 50%);
        --color-edge: hsl(var(--themeColor), 30%, 18%);
        --font-primary: "Rajdhani", system-ui;
        --radius-interactive: 0.4rem;
      }

      html {
        background: hsl(var(--themeColor), 20%, 8%);
        color: hsl(var(--themeColor), 100%, 92%);
        font-family: "Rajdhani", system-ui;
        min-height: 100vh;
      }

      body {
        background: hsl(var(--themeColor), 20%, 8%);
        color: hsl(var(--themeColor), 100%, 92%);
        font-family: "Rajdhani", system-ui;
        margin: 0;
        padding: 0;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* Universal Page Styles */
      .universal-page-container {
        background: hsl(var(--themeColor), 20%, 8%);
        min-height: 100vh;
        position: relative;
      }

      .universal-grid-bg {
        background-image:
          linear-gradient(
            hsl(var(--themeColor), 100%, 50%, 0.1) 1px,
            transparent 1px
          ),
          linear-gradient(
            90deg,
            hsl(var(--themeColor), 100%, 50%, 0.1) 1px,
            transparent 1px
          );
        background-size: 20px 20px;
        min-height: 100vh;
      }

      /* Header Section */
      .page-header-section {
        border: 1px solid hsl(var(--themeColor), 30%, 18%);
        background: linear-gradient(
          135deg,
          hsl(var(--themeColor), 20%, 10%) 0%,
          hsl(var(--themeColor), 40%, 12%) 100%
        );
        position: relative;
      }

      .page-header-container {
        max-width: 1200px;
        margin: 0 auto;
        border-left: 1px solid hsl(var(--themeColor), 30%, 18%);
        border-right: 1px solid hsl(var(--themeColor), 30%, 18%);
        min-height: 200px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 2rem;
      }

      .page-title-section {
        flex: 1;
      }

      .page-title {
        font-size: 3rem;
        font-weight: 700;
        color: hsl(var(--themeColor), 100%, 50%);
        text-shadow: 0 0 15px hsl(var(--themeColor), 100%, 50%, 0.5);
        margin-bottom: 0.5rem;
        letter-spacing: 0.1em;
        font-family: "Rajdhani", system-ui;
      }

      .page-subtitle {
        font-size: 1.2rem;
        color: hsl(var(--themeColor), 100%, 70%);
        opacity: 0.8;
        margin-bottom: 1rem;
      }

      .page-status-indicators {
        display: flex;
        gap: 1rem;
        font-family: monospace;
        font-size: 0.9rem;
      }

      .status-item {
        color: hsl(var(--themeColor), 100%, 60%);
      }

      .status-online {
        color: #4ade80;
      }
      
      /* Global page spacing - all pages start 5px below banner */
      body main {
        padding-top: 5px !important;
        margin-top: 0 !important;
      }
      
      /* Ensure subpages use consistent top spacing */
      .page-content {
        padding-top: 5px !important;
        margin-top: 0 !important;
      }
      
      /* Override any other margin/padding that might interfere */
      main > section:first-child,
      main > div:first-child,
      main > article:first-child {
        margin-top: 0 !important;
        padding-top: 5px !important;
      }
      
      /* Top banner rectangle for all subpages */
      .top-banner-rect {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: calc(80px + 5px); /* Header height + 5px */
        background: transparent;
        border: 1px solid rgba(255, 255, 255, 0.3);
        z-index: 15; /* Below header but above content */
        pointer-events: none;
      }

      .status-active {
        color: #00d9ff;
      }

      /* Quote Section */
      .page-quote-section {
        position: absolute;
        top: 2rem;
        right: 2rem;
        max-width: 400px;
        text-align: right;
      }

      .custom-quote {
        padding: 1rem;
        border: 1px solid hsl(var(--themeColor), 100%, 50%, 0.3);
        border-radius: 8px;
        background: rgba(0, 0, 0, 0.4);
        margin-bottom: 1rem;
      }

      .custom-quote-text {
        color: #00d9ff;
        font-style: italic;
        font-size: 1rem;
        line-height: 1.4;
        margin-bottom: 0.5rem;
      }

      .custom-quote-author {
        color: #9bdfff;
        font-size: 0.9rem;
      }

      /* Main Content Section */
      .page-content-section {
        border-left: 1px solid hsl(var(--themeColor), 30%, 18%);
        border-right: 1px solid hsl(var(--themeColor), 30%, 18%);
        border-bottom: 1px solid hsl(var(--themeColor), 30%, 18%);
        max-width: 1200px;
        margin: 0 auto;
        min-height: calc(100vh - 200px);
        background: rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(10px);
      }

      .page-content-inner {
        padding: 2rem;
      }

      /* Decorative Lines */
      .decorative-lines {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        pointer-events: none;
        z-index: 1;
      }

      .vertical-line {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 1px;
        background: hsl(var(--themeColor), 30%, 18%);
      }

      .line-left-inner { left: calc(50vw - 600px); }
      .line-right-inner { right: calc(50vw - 600px); }
      .line-left-outer { left: calc(50vw - 700px); }
      .line-right-outer { right: calc(50vw - 700px); }

      /* Responsive Design */
      @media (max-width: 1400px) {
        .line-left-outer, .line-right-outer { display: none; }
      }

      @media (max-width: 1200px) {
        .line-left-inner, .line-right-inner { display: none; }
        .page-quote-section {
          position: static;
          max-width: none;
          text-align: center;
          margin-top: 2rem;
        }
        .page-header-container {
          flex-direction: column;
          text-align: center;
        }
      }

      @media (max-width: 768px) {
        .page-title { font-size: 2rem; }
        .page-header-container { padding: 1rem; }
        .page-content-inner { padding: 1rem; }
      }

      /* Compact Header */
      .compact-header :where(nav, header) {
        --header-padding-y: 6px;
        --header-padding-x: 10px;
      }
      .compact-header :where(.header-container) {
        padding-top: 6px !important;
        padding-bottom: 6px !important;
      }
      .compact-header :where(.logo img) {
        height: 24px !important;
        width: auto;
      }
    </style>
  </head>

  <body class="universal-page-container">
    <BgAnimation client:load />
    
    <!-- Top banner rectangle for all subpages -->
    <div class="top-banner-rect"></div>
    
<<<<<<< HEAD
    <!-- Floating Header -->
    <div class="compact-header">
      <Header
        headerType="floating"
        logoSrc="/favicon.svg"
        logoAlt={pageTitle}
        logoWidth="24px"
        homeUrl="/"
        menuItems={menuItems}
        backgroundColor="#0d0d0dcc"
        backdropBlur="blur(16px)"
        zIndex={20}
      />
    </div>
=======
    <!-- Floating Header - Usunięte (był dynamic-header) -->
>>>>>>> c1c4ac5534f2943dcdcdd273d347cf64339cc1a7

    <!-- Decorative Background Lines -->
    <div class="decorative-lines">
      <div class="vertical-line line-left-outer"></div>
      <div class="vertical-line line-right-outer"></div>
      <div class="vertical-line line-left-inner"></div>
      <div class="vertical-line line-right-inner"></div>
    </div>

    <PageTransition key={pageKey}>
      <main class="universal-grid-bg">
        <!-- Page Header Section -->
        <section class="page-header-section">
          <div class="page-header-container">
            <div class="page-title-section">
              <h1 class="page-title">{siteTitle || pageTitle}</h1>
              {(description || pageDescription) && (
                <p class="page-subtitle">{description || pageDescription}</p>
              )}
              <div class="page-status-indicators">
                <div class="status-item">SYSTEM STATUS: <span class="status-online">ONLINE</span></div>
                <div class="status-item">AI MODELS: <span class="status-active">ACTIVE</span></div>
              </div>
            </div>

            <!-- Quote Section -->
            <div class="page-quote-section">
              {pageQuote && pageAuthor ? (
                <div class="custom-quote">
                  <div class="custom-quote-text">"{pageQuote}"</div>
                  <div class="custom-quote-author">— {pageAuthor}</div>
                </div>
              ) : showRandomQuote && (
                <RandomQuote />
              )}
              <div style="font-family: monospace; font-size: 0.9rem; color: #666; margin-top: 1rem;">
                {new Date().toLocaleDateString('pl-PL', { 
                  year: 'numeric', 
                  month: 'short',
                  day: 'numeric'
                }).toUpperCase()}
              </div>
            </div>
          </div>
        </section>

        <!-- Main Content Section -->
        <section class="page-content-section">
          <div class="page-content-inner">
            <slot />
          </div>
        </section>
      </main>
    </PageTransition>
  </body>
</html>